
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Tasks for interacting with AWS Secrets Manager">
      
      
      
        <link rel="canonical" href="https://PrefectHQ.github.io/prefect-aws/secrets_manager/">
      
      <link rel="icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.4.1, mkdocs-material-8.5.6">
    
    
      
        <title>Secrets Manager - prefect-aws</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.20d9efc8.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#2094f3">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CSource+Code+Pro:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"Source Code Pro"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#prefect_aws.secrets_manager" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="prefect-aws" class="md-header__button md-logo" aria-label="prefect-aws" data-md-component="logo">
      
  <img src="../img/prefect-logo-mark-solid-white-500.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            prefect-aws
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Secrets Manager
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/PrefectHQ/prefect-aws" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="prefect-aws" class="md-nav__button md-logo" aria-label="prefect-aws" data-md-component="logo">
      
  <img src="../img/prefect-logo-mark-solid-white-500.png" alt="logo">

    </a>
    prefect-aws
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/PrefectHQ/prefect-aws" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../batch/" class="md-nav__link">
        Batch
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../client_waiter/" class="md-nav__link">
        Client Waiter
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../credentials/" class="md-nav__link">
        Credentials
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ecs/" class="md-nav__link">
        ECS
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../s3/" class="md-nav__link">
        S3
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Secrets Manager
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Secrets Manager
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prefect_aws.secrets_manager-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefect_aws.secrets_manager.create_secret" class="md-nav__link">
    create_secret()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.secrets_manager.delete_secret" class="md-nav__link">
    delete_secret()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.secrets_manager.read_secret" class="md-nav__link">
    read_secret()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.secrets_manager.update_secret" class="md-nav__link">
    update_secret()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prefect_aws.secrets_manager-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefect_aws.secrets_manager.create_secret" class="md-nav__link">
    create_secret()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.secrets_manager.delete_secret" class="md-nav__link">
    delete_secret()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.secrets_manager.read_secret" class="md-nav__link">
    read_secret()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.secrets_manager.update_secret" class="md-nav__link">
    update_secret()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/PrefectHQ/prefect-aws/edit/main/docs/secrets_manager.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<div class="doc doc-object doc-module">



<h1 id="prefect_aws.secrets_manager" class="doc doc-heading">
        <code>prefect_aws.secrets_manager</code>



</h1>

    <div class="doc doc-contents first">

      <p>Tasks for interacting with AWS Secrets Manager</p>



  <div class="doc doc-children">






<h2 id="prefect_aws.secrets_manager-functions">Functions</h2>

  <div class="doc doc-object doc-function">



<h3 id="prefect_aws.secrets_manager.create_secret" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_secret</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Creates a secret in AWS Secrets Manager.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>secret_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the secret to create.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>secret_value</code></td>
        <td><code>Union[str, bytes]</code></td>
        <td><p>The value to store in the created secret.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>aws_credentials</code></td>
        <td><code>AwsCredentials</code></td>
        <td><p>Credentials to use for authentication with AWS.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>description</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>A description for the created secret.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>tags</code></td>
        <td><code>Optional[List[Dict[str, str]]]</code></td>
        <td><p>A list of tags to attach to the secret. Each tag should be specified as a
dictionary in the following format:
<div class="highlight"><pre><span></span><code><span class="p">{</span>
    <span class="s2">&quot;Key&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="s2">&quot;Value&quot;</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">}</span>
</code></pre></div></p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>A dict containing the secret ARN (Amazon Resource Name),
    name, and current version ID.
    ```python
    {
        &#34;ARN&#34;</code></td>
      <td><p>str,
        "Name": str,
        "VersionId": str
    }
    ```</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <p>Create a secret:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect</span> <span class="kn">import</span> <span class="n">flow</span>
<span class="kn">from</span> <span class="nn">prefect_aws</span> <span class="kn">import</span> <span class="n">AwsCredentials</span>
<span class="kn">from</span> <span class="nn">prefect_aws.secrets_manager</span> <span class="kn">import</span> <span class="n">create_secret</span>

<span class="nd">@flow</span>
<span class="k">def</span> <span class="nf">example_create_secret</span><span class="p">():</span>
    <span class="n">aws_credentials</span> <span class="o">=</span> <span class="n">AwsCredentials</span><span class="p">(</span>
        <span class="n">aws_access_key_id</span><span class="o">=</span><span class="s2">&quot;access_key_id&quot;</span><span class="p">,</span>
        <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="s2">&quot;secret_access_key&quot;</span>
    <span class="p">)</span>
    <span class="n">create_secret</span><span class="p">(</span>
        <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;life_the_universe_and_everything&quot;</span><span class="p">,</span>
        <span class="n">secret_value</span><span class="o">=</span><span class="s2">&quot;42&quot;</span><span class="p">,</span>
        <span class="n">aws_credentials</span><span class="o">=</span><span class="n">aws_credentials</span>
    <span class="p">)</span>

<span class="n">example_create_secret</span><span class="p">()</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>prefect_aws/secrets_manager.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@task</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">create_secret</span><span class="p">(</span>
    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">secret_value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
    <span class="n">aws_credentials</span><span class="p">:</span> <span class="n">AwsCredentials</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a secret in AWS Secrets Manager.</span>

<span class="sd">    Args:</span>
<span class="sd">        secret_name: The name of the secret to create.</span>
<span class="sd">        secret_value: The value to store in the created secret.</span>
<span class="sd">        aws_credentials: Credentials to use for authentication with AWS.</span>
<span class="sd">        description: A description for the created secret.</span>
<span class="sd">        tags: A list of tags to attach to the secret. Each tag should be specified as a</span>
<span class="sd">            dictionary in the following format:</span>
<span class="sd">            ```python</span>
<span class="sd">            {</span>
<span class="sd">                &quot;Key&quot;: str,</span>
<span class="sd">                &quot;Value&quot;: str</span>
<span class="sd">            }</span>
<span class="sd">            ```</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dict containing the secret ARN (Amazon Resource Name),</span>
<span class="sd">            name, and current version ID.</span>
<span class="sd">            ```python</span>
<span class="sd">            {</span>
<span class="sd">                &quot;ARN&quot;: str,</span>
<span class="sd">                &quot;Name&quot;: str,</span>
<span class="sd">                &quot;VersionId&quot;: str</span>
<span class="sd">            }</span>
<span class="sd">            ```</span>
<span class="sd">    Example:</span>
<span class="sd">        Create a secret:</span>

<span class="sd">        ```python</span>
<span class="sd">        from prefect import flow</span>
<span class="sd">        from prefect_aws import AwsCredentials</span>
<span class="sd">        from prefect_aws.secrets_manager import create_secret</span>

<span class="sd">        @flow</span>
<span class="sd">        def example_create_secret():</span>
<span class="sd">            aws_credentials = AwsCredentials(</span>
<span class="sd">                aws_access_key_id=&quot;access_key_id&quot;,</span>
<span class="sd">                aws_secret_access_key=&quot;secret_access_key&quot;</span>
<span class="sd">            )</span>
<span class="sd">            create_secret(</span>
<span class="sd">                secret_name=&quot;life_the_universe_and_everything&quot;,</span>
<span class="sd">                secret_value=&quot;42&quot;,</span>
<span class="sd">                aws_credentials=aws_credentials</span>
<span class="sd">            )</span>

<span class="sd">        example_create_secret()</span>
<span class="sd">        ```</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">create_secret_kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">Name</span><span class="o">=</span><span class="n">secret_name</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">create_secret_kwargs</span><span class="p">[</span><span class="s2">&quot;Description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>
    <span class="k">if</span> <span class="n">tags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">create_secret_kwargs</span><span class="p">[</span><span class="s2">&quot;Tags&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tags</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">secret_value</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
        <span class="n">create_secret_kwargs</span><span class="p">[</span><span class="s2">&quot;SecretBinary&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">secret_value</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">secret_value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">create_secret_kwargs</span><span class="p">[</span><span class="s2">&quot;SecretString&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">secret_value</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Please provide a bytes or str value for secret_value&quot;</span><span class="p">)</span>

    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_run_logger</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Creating secret named </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="p">)</span>

    <span class="n">client</span> <span class="o">=</span> <span class="n">aws_credentials</span><span class="o">.</span><span class="n">get_boto3_session</span><span class="p">()</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;secretsmanager&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">run_sync_in_worker_thread</span><span class="p">(</span>
            <span class="n">client</span><span class="o">.</span><span class="n">create_secret</span><span class="p">,</span> <span class="o">**</span><span class="n">create_secret_kwargs</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;ResponseMetadata&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">response</span>
    <span class="k">except</span> <span class="n">ClientError</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Unable to create secret </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="prefect_aws.secrets_manager.delete_secret" class="doc doc-heading">
<code class="highlight language-python"><span class="n">delete_secret</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Deletes a secret from AWS Secrets Manager.</p>
<p>Secrets can either be deleted immediately by setting <code>force_delete_without_recovery</code>
equal to <code>True</code>. Otherwise, secrets will be marked for deletion and available for
recovery for the number of days specified in <code>recovery_window_in_days</code></p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>secret_name</code></td>
        <td><code>str</code></td>
        <td><p>Name of the secret to be deleted.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>aws_credentials</code></td>
        <td><code>AwsCredentials</code></td>
        <td><p>Credentials to use for authentication with AWS.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>recovery_window_in_days</code></td>
        <td><code>int</code></td>
        <td><p>Number of days a secret should be recoverable for
before permanent deletion. Minium window is 7 days and maximum window
is 30 days. If <code>force_delete_without_recovery</code> is set to <code>True</code>, this
value will be ignored.</p></td>
        <td><code>30</code></td>
      </tr>
      <tr>
        <td><code>force_delete_without_recovery</code></td>
        <td><code>bool</code></td>
        <td><p>If <code>True</code>, the secret will be immediately
deleted and will not be recoverable.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>A dict containing the secret ARN (Amazon Resource Name),
    name, and deletion date of the secret. DeletionDate is the date and
    time of the delete request plus the number of days in
    `recovery_window_in_days`.
    ```python
    {
        &#34;ARN&#34;</code></td>
      <td><p>str,
        "Name": str,
        "DeletionDate": datetime.datetime
    }
    ```</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <p>Delete a secret immediately:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect</span> <span class="kn">import</span> <span class="n">flow</span>
<span class="kn">from</span> <span class="nn">prefect_aws</span> <span class="kn">import</span> <span class="n">AwsCredentials</span>
<span class="kn">from</span> <span class="nn">prefect_aws.secrets_manager</span> <span class="kn">import</span> <span class="n">delete_secret</span>

<span class="nd">@flow</span>
<span class="k">def</span> <span class="nf">example_delete_secret_immediately</span><span class="p">():</span>
    <span class="n">aws_credentials</span> <span class="o">=</span> <span class="n">AwsCredentials</span><span class="p">(</span>
        <span class="n">aws_access_key_id</span><span class="o">=</span><span class="s2">&quot;access_key_id&quot;</span><span class="p">,</span>
        <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="s2">&quot;secret_access_key&quot;</span>
    <span class="p">)</span>
    <span class="n">delete_secret</span><span class="p">(</span>
        <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;life_the_universe_and_everything&quot;</span><span class="p">,</span>
        <span class="n">aws_credentials</span><span class="o">=</span><span class="n">aws_credentials</span><span class="p">,</span>
        <span class="n">force_delete_without_recovery</span><span class="p">:</span> <span class="kc">True</span>
    <span class="p">)</span>

<span class="n">example_delete_secret_immediately</span><span class="p">()</span>
</code></pre></div>
<p>Delete a secret with a 90 day recovery window:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect</span> <span class="kn">import</span> <span class="n">flow</span>
<span class="kn">from</span> <span class="nn">prefect_aws</span> <span class="kn">import</span> <span class="n">AwsCredentials</span>
<span class="kn">from</span> <span class="nn">prefect_aws.secrets_manager</span> <span class="kn">import</span> <span class="n">delete_secret</span>

<span class="nd">@flow</span>
<span class="k">def</span> <span class="nf">example_delete_secret_with_recovery_window</span><span class="p">():</span>
    <span class="n">aws_credentials</span> <span class="o">=</span> <span class="n">AwsCredentials</span><span class="p">(</span>
        <span class="n">aws_access_key_id</span><span class="o">=</span><span class="s2">&quot;access_key_id&quot;</span><span class="p">,</span>
        <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="s2">&quot;secret_access_key&quot;</span>
    <span class="p">)</span>
    <span class="n">delete_secret</span><span class="p">(</span>
        <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;life_the_universe_and_everything&quot;</span><span class="p">,</span>
        <span class="n">aws_credentials</span><span class="o">=</span><span class="n">aws_credentials</span><span class="p">,</span>
        <span class="n">recovery_window_in_days</span><span class="o">=</span><span class="mi">90</span>
    <span class="p">)</span>

<span class="n">example_delete_secret_with_recovery_window</span><span class="p">()</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>prefect_aws/secrets_manager.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@task</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">delete_secret</span><span class="p">(</span>
    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">aws_credentials</span><span class="p">:</span> <span class="n">AwsCredentials</span><span class="p">,</span>
    <span class="n">recovery_window_in_days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
    <span class="n">force_delete_without_recovery</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deletes a secret from AWS Secrets Manager.</span>

<span class="sd">    Secrets can either be deleted immediately by setting `force_delete_without_recovery`</span>
<span class="sd">    equal to `True`. Otherwise, secrets will be marked for deletion and available for</span>
<span class="sd">    recovery for the number of days specified in `recovery_window_in_days`</span>

<span class="sd">    Args:</span>
<span class="sd">        secret_name: Name of the secret to be deleted.</span>
<span class="sd">        aws_credentials: Credentials to use for authentication with AWS.</span>
<span class="sd">        recovery_window_in_days: Number of days a secret should be recoverable for</span>
<span class="sd">            before permanent deletion. Minium window is 7 days and maximum window</span>
<span class="sd">            is 30 days. If `force_delete_without_recovery` is set to `True`, this</span>
<span class="sd">            value will be ignored.</span>
<span class="sd">        force_delete_without_recovery: If `True`, the secret will be immediately</span>
<span class="sd">            deleted and will not be recoverable.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dict containing the secret ARN (Amazon Resource Name),</span>
<span class="sd">            name, and deletion date of the secret. DeletionDate is the date and</span>
<span class="sd">            time of the delete request plus the number of days in</span>
<span class="sd">            `recovery_window_in_days`.</span>
<span class="sd">            ```python</span>
<span class="sd">            {</span>
<span class="sd">                &quot;ARN&quot;: str,</span>
<span class="sd">                &quot;Name&quot;: str,</span>
<span class="sd">                &quot;DeletionDate&quot;: datetime.datetime</span>
<span class="sd">            }</span>
<span class="sd">            ```</span>

<span class="sd">    Examples:</span>
<span class="sd">        Delete a secret immediately:</span>

<span class="sd">        ```python</span>
<span class="sd">        from prefect import flow</span>
<span class="sd">        from prefect_aws import AwsCredentials</span>
<span class="sd">        from prefect_aws.secrets_manager import delete_secret</span>

<span class="sd">        @flow</span>
<span class="sd">        def example_delete_secret_immediately():</span>
<span class="sd">            aws_credentials = AwsCredentials(</span>
<span class="sd">                aws_access_key_id=&quot;access_key_id&quot;,</span>
<span class="sd">                aws_secret_access_key=&quot;secret_access_key&quot;</span>
<span class="sd">            )</span>
<span class="sd">            delete_secret(</span>
<span class="sd">                secret_name=&quot;life_the_universe_and_everything&quot;,</span>
<span class="sd">                aws_credentials=aws_credentials,</span>
<span class="sd">                force_delete_without_recovery: True</span>
<span class="sd">            )</span>

<span class="sd">        example_delete_secret_immediately()</span>
<span class="sd">        ```</span>

<span class="sd">        Delete a secret with a 90 day recovery window:</span>

<span class="sd">        ```python</span>
<span class="sd">        from prefect import flow</span>
<span class="sd">        from prefect_aws import AwsCredentials</span>
<span class="sd">        from prefect_aws.secrets_manager import delete_secret</span>

<span class="sd">        @flow</span>
<span class="sd">        def example_delete_secret_with_recovery_window():</span>
<span class="sd">            aws_credentials = AwsCredentials(</span>
<span class="sd">                aws_access_key_id=&quot;access_key_id&quot;,</span>
<span class="sd">                aws_secret_access_key=&quot;secret_access_key&quot;</span>
<span class="sd">            )</span>
<span class="sd">            delete_secret(</span>
<span class="sd">                secret_name=&quot;life_the_universe_and_everything&quot;,</span>
<span class="sd">                aws_credentials=aws_credentials,</span>
<span class="sd">                recovery_window_in_days=90</span>
<span class="sd">            )</span>

<span class="sd">        example_delete_secret_with_recovery_window()</span>
<span class="sd">        ```</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">force_delete_without_recovery</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">7</span> <span class="o">&lt;=</span> <span class="n">recovery_window_in_days</span> <span class="o">&lt;=</span> <span class="mi">30</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Recovery window must be between 7 and 30 days.&quot;</span><span class="p">)</span>

    <span class="n">delete_secret_kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">SecretId</span><span class="o">=</span><span class="n">secret_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">force_delete_without_recovery</span><span class="p">:</span>
        <span class="n">delete_secret_kwargs</span><span class="p">[</span>
            <span class="s2">&quot;ForceDeleteWithoutRecovery&quot;</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">force_delete_without_recovery</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">delete_secret_kwargs</span><span class="p">[</span><span class="s2">&quot;RecoveryWindowInDays&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">recovery_window_in_days</span>

    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_run_logger</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Deleting secret </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="p">)</span>

    <span class="n">client</span> <span class="o">=</span> <span class="n">aws_credentials</span><span class="o">.</span><span class="n">get_boto3_session</span><span class="p">()</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;secretsmanager&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">run_sync_in_worker_thread</span><span class="p">(</span>
            <span class="n">client</span><span class="o">.</span><span class="n">delete_secret</span><span class="p">,</span> <span class="o">**</span><span class="n">delete_secret_kwargs</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;ResponseMetadata&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span>
    <span class="k">except</span> <span class="n">ClientError</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Unable to delete secret </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="prefect_aws.secrets_manager.read_secret" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read_secret</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Reads the value of a given secret from AWS Secrets Manager.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>secret_name</code></td>
        <td><code>str</code></td>
        <td><p>Name of stored secret.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>aws_credentials</code></td>
        <td><code>AwsCredentials</code></td>
        <td><p>Credentials to use for authentication with AWS.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>version_id</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Specifies version of secret to read. Defaults to the most recent
version if not given.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>version_stage</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Specifies the version stage of the secret to read. Defaults to
AWS_CURRENT if not given.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Union[str, bytes]</code></td>
      <td><p>The secret values as a <code>str</code> or <code>bytes</code> depending on the format in which the
    secret was stored.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <p>Read a secret value:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect</span> <span class="kn">import</span> <span class="n">flow</span>
<span class="kn">from</span> <span class="nn">prefect_aws</span> <span class="kn">import</span> <span class="n">AwsCredentials</span>
<span class="kn">from</span> <span class="nn">prefect_aws.secrets_manager</span> <span class="kn">import</span> <span class="n">read_secret</span>

<span class="nd">@flow</span>
<span class="k">def</span> <span class="nf">example_read_secret</span><span class="p">():</span>
    <span class="n">aws_credentials</span> <span class="o">=</span> <span class="n">AwsCredentials</span><span class="p">(</span>
        <span class="n">aws_access_key_id</span><span class="o">=</span><span class="s2">&quot;access_key_id&quot;</span><span class="p">,</span>
        <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="s2">&quot;secret_access_key&quot;</span>
    <span class="p">)</span>
    <span class="n">secret_value</span> <span class="o">=</span> <span class="n">read_secret</span><span class="p">(</span>
        <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;db_password&quot;</span><span class="p">,</span>
        <span class="n">aws_credentials</span><span class="o">=</span><span class="n">aws_credentials</span>
    <span class="p">)</span>

<span class="n">example_read_secret</span><span class="p">()</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>prefect_aws/secrets_manager.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@task</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">read_secret</span><span class="p">(</span>
    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">aws_credentials</span><span class="p">:</span> <span class="n">AwsCredentials</span><span class="p">,</span>
    <span class="n">version_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">version_stage</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reads the value of a given secret from AWS Secrets Manager.</span>

<span class="sd">    Args:</span>
<span class="sd">        secret_name: Name of stored secret.</span>
<span class="sd">        aws_credentials: Credentials to use for authentication with AWS.</span>
<span class="sd">        version_id: Specifies version of secret to read. Defaults to the most recent</span>
<span class="sd">            version if not given.</span>
<span class="sd">        version_stage: Specifies the version stage of the secret to read. Defaults to</span>
<span class="sd">            AWS_CURRENT if not given.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The secret values as a `str` or `bytes` depending on the format in which the</span>
<span class="sd">            secret was stored.</span>

<span class="sd">    Example:</span>
<span class="sd">        Read a secret value:</span>

<span class="sd">        ```python</span>
<span class="sd">        from prefect import flow</span>
<span class="sd">        from prefect_aws import AwsCredentials</span>
<span class="sd">        from prefect_aws.secrets_manager import read_secret</span>

<span class="sd">        @flow</span>
<span class="sd">        def example_read_secret():</span>
<span class="sd">            aws_credentials = AwsCredentials(</span>
<span class="sd">                aws_access_key_id=&quot;access_key_id&quot;,</span>
<span class="sd">                aws_secret_access_key=&quot;secret_access_key&quot;</span>
<span class="sd">            )</span>
<span class="sd">            secret_value = read_secret(</span>
<span class="sd">                secret_name=&quot;db_password&quot;,</span>
<span class="sd">                aws_credentials=aws_credentials</span>
<span class="sd">            )</span>

<span class="sd">        example_read_secret()</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_run_logger</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Getting value for secret </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="p">)</span>

    <span class="n">client</span> <span class="o">=</span> <span class="n">aws_credentials</span><span class="o">.</span><span class="n">get_boto3_session</span><span class="p">()</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;secretsmanager&quot;</span><span class="p">)</span>

    <span class="n">get_secret_value_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">SecretId</span><span class="o">=</span><span class="n">secret_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">version_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">get_secret_value_kwargs</span><span class="p">[</span><span class="s2">&quot;VersionId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">version_id</span>
    <span class="k">if</span> <span class="n">version_stage</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">get_secret_value_kwargs</span><span class="p">[</span><span class="s2">&quot;VersionStage&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">version_stage</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">run_sync_in_worker_thread</span><span class="p">(</span>
            <span class="n">client</span><span class="o">.</span><span class="n">get_secret_value</span><span class="p">,</span> <span class="o">**</span><span class="n">get_secret_value_kwargs</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="n">ClientError</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Unable to get value for secret </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="p">)</span>
        <span class="k">raise</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SecretString&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SecretBinary&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="prefect_aws.secrets_manager.update_secret" class="doc doc-heading">
<code class="highlight language-python"><span class="n">update_secret</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Updates the value of a given secret in AWS Secrets Manager.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>secret_name</code></td>
        <td><code>str</code></td>
        <td><p>Name of secret to update.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>secret_value</code></td>
        <td><code>Union[str, bytes]</code></td>
        <td><p>Desired value of the secret. Can be either <code>str</code> or <code>bytes</code>.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>aws_credentials</code></td>
        <td><code>AwsCredentials</code></td>
        <td><p>Credentials to use for authentication with AWS.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>description</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Desired description of the secret.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>A dict containing the secret ARN (Amazon Resource Name),
    name, and current version ID.
    ```python
    {
        &#34;ARN&#34;</code></td>
      <td><p>str,
        "Name": str,
        "VersionId": str
    }
    ```</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <p>Update a secret value:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect</span> <span class="kn">import</span> <span class="n">flow</span>
<span class="kn">from</span> <span class="nn">prefect_aws</span> <span class="kn">import</span> <span class="n">AwsCredentials</span>
<span class="kn">from</span> <span class="nn">prefect_aws.secrets_manager</span> <span class="kn">import</span> <span class="n">update_secret</span>

<span class="nd">@flow</span>
<span class="k">def</span> <span class="nf">example_update_secret</span><span class="p">():</span>
    <span class="n">aws_credentials</span> <span class="o">=</span> <span class="n">AwsCredentials</span><span class="p">(</span>
        <span class="n">aws_access_key_id</span><span class="o">=</span><span class="s2">&quot;access_key_id&quot;</span><span class="p">,</span>
        <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="s2">&quot;secret_access_key&quot;</span>
    <span class="p">)</span>
    <span class="n">update_secret</span><span class="p">(</span>
        <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;life_the_universe_and_everything&quot;</span><span class="p">,</span>
        <span class="n">secret_value</span><span class="o">=</span><span class="s2">&quot;42&quot;</span><span class="p">,</span>
        <span class="n">aws_credentials</span><span class="o">=</span><span class="n">aws_credentials</span>
    <span class="p">)</span>

<span class="n">example_update_secret</span><span class="p">()</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>prefect_aws/secrets_manager.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@task</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">update_secret</span><span class="p">(</span>
    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">secret_value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
    <span class="n">aws_credentials</span><span class="p">:</span> <span class="n">AwsCredentials</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates the value of a given secret in AWS Secrets Manager.</span>

<span class="sd">    Args:</span>
<span class="sd">        secret_name: Name of secret to update.</span>
<span class="sd">        secret_value: Desired value of the secret. Can be either `str` or `bytes`.</span>
<span class="sd">        aws_credentials: Credentials to use for authentication with AWS.</span>
<span class="sd">        description: Desired description of the secret.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dict containing the secret ARN (Amazon Resource Name),</span>
<span class="sd">            name, and current version ID.</span>
<span class="sd">            ```python</span>
<span class="sd">            {</span>
<span class="sd">                &quot;ARN&quot;: str,</span>
<span class="sd">                &quot;Name&quot;: str,</span>
<span class="sd">                &quot;VersionId&quot;: str</span>
<span class="sd">            }</span>
<span class="sd">            ```</span>

<span class="sd">    Example:</span>
<span class="sd">        Update a secret value:</span>

<span class="sd">        ```python</span>
<span class="sd">        from prefect import flow</span>
<span class="sd">        from prefect_aws import AwsCredentials</span>
<span class="sd">        from prefect_aws.secrets_manager import update_secret</span>

<span class="sd">        @flow</span>
<span class="sd">        def example_update_secret():</span>
<span class="sd">            aws_credentials = AwsCredentials(</span>
<span class="sd">                aws_access_key_id=&quot;access_key_id&quot;,</span>
<span class="sd">                aws_secret_access_key=&quot;secret_access_key&quot;</span>
<span class="sd">            )</span>
<span class="sd">            update_secret(</span>
<span class="sd">                secret_name=&quot;life_the_universe_and_everything&quot;,</span>
<span class="sd">                secret_value=&quot;42&quot;,</span>
<span class="sd">                aws_credentials=aws_credentials</span>
<span class="sd">            )</span>

<span class="sd">        example_update_secret()</span>
<span class="sd">        ```</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">update_secret_kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">SecretId</span><span class="o">=</span><span class="n">secret_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">update_secret_kwargs</span><span class="p">[</span><span class="s2">&quot;Description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">secret_value</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
        <span class="n">update_secret_kwargs</span><span class="p">[</span><span class="s2">&quot;SecretBinary&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">secret_value</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">secret_value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">update_secret_kwargs</span><span class="p">[</span><span class="s2">&quot;SecretString&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">secret_value</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Please provide a bytes or str value for secret_value&quot;</span><span class="p">)</span>

    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_run_logger</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Updating value for secret </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="p">)</span>

    <span class="n">client</span> <span class="o">=</span> <span class="n">aws_credentials</span><span class="o">.</span><span class="n">get_boto3_session</span><span class="p">()</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;secretsmanager&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">run_sync_in_worker_thread</span><span class="p">(</span>
            <span class="n">client</span><span class="o">.</span><span class="n">update_secret</span><span class="p">,</span> <span class="o">**</span><span class="n">update_secret_kwargs</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;ResponseMetadata&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span>
    <span class="k">except</span> <span class="n">ClientError</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Unable to update secret </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../s3/" class="md-footer__link md-footer__link--prev" aria-label="Previous: S3" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              S3
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.5bf1dace.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.078830c0.min.js"></script>
      
    
  </body>
</html>