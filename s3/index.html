
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Tasks for interacting with AWS S3">
      
      
      
        <link rel="canonical" href="https://PrefectHQ.github.io/prefect-aws/s3/">
      
      
        <link rel="prev" href="../deployments/steps/">
      
      
        <link rel="next" href="../secrets_manager/">
      
      
      <link rel="icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.18">
    
    
      
        <title>S3 - prefect-aws</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.66ac8b77.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CSource+Code+Pro:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"Source Code Pro"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8CSMBCQDKN"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-8CSMBCQDKN');
</script>
<!-- Segment analytics -->
<script>
    !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on","addSourceMiddleware","addIntegrationMiddleware","setAnonymousId","addDestinationMiddleware"];analytics.factory=function(e){return function(){var t=Array.prototype.slice.call(arguments);t.unshift(e);analytics.push(t);return analytics}};for(var e=0;e<analytics.methods.length;e++){var key=analytics.methods[e];analytics[key]=analytics.factory(key)}analytics.load=function(key,e){var t=document.createElement("script");t.type="text/javascript";t.async=!0;t.src="https://cdn.segment.com/analytics.js/v1/" + key + "/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n);analytics._loadOptions=e};analytics._writeKey="xDLAoTXsNYpC4Y6JucKnJ8W1MYBuyAbD";;analytics.SNIPPET_VERSION="4.15.3";
    analytics.load("xDLAoTXsNYpC4Y6JucKnJ8W1MYBuyAbD");
    analytics.page();
    }}();
</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#prefect_aws.s3" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="prefect-aws" class="md-header__button md-logo" aria-label="prefect-aws" data-md-component="logo">
      
  <img src="../img/prefect-logo-mark.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            prefect-aws
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              S3
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/PrefectHQ/prefect-aws" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="prefect-aws" class="md-nav__button md-logo" aria-label="prefect-aws" data-md-component="logo">
      
  <img src="../img/prefect-logo-mark.png" alt="logo">

    </a>
    prefect-aws
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/PrefectHQ/prefect-aws" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ecs_guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ECS Worker Guide
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../blocks_catalog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blocks Catalog
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples_catalog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Examples Catalog
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../batch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Batch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../client_waiter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Client Waiter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../credentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Credentials
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ecs_worker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ECS Worker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ecs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ECS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lambda_function/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lambda
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_7" >
        
          
          <label class="md-nav__link" for="__nav_6_7" id="__nav_6_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Deployments
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_7">
            <span class="md-nav__icon md-icon"></span>
            Deployments
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../deployments/steps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Steps
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    S3
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    S3
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prefect_aws.s3-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket" class="md-nav__link">
    <span class="md-ellipsis">
      S3Bucket
    </span>
  </a>
  
    <nav class="md-nav" aria-label="S3Bucket">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.basepath" class="md-nav__link">
    <span class="md-ellipsis">
      basepath
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.bucket_folder" class="md-nav__link">
    <span class="md-ellipsis">
      bucket_folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.bucket_name" class="md-nav__link">
    <span class="md-ellipsis">
      bucket_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.credentials" class="md-nav__link">
    <span class="md-ellipsis">
      credentials
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.__json_encoder__" class="md-nav__link">
    <span class="md-ellipsis">
      __json_encoder__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.copy_object" class="md-nav__link">
    <span class="md-ellipsis">
      copy_object()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.download_folder_to_path" class="md-nav__link">
    <span class="md-ellipsis">
      download_folder_to_path()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.download_object_to_file_object" class="md-nav__link">
    <span class="md-ellipsis">
      download_object_to_file_object()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.download_object_to_path" class="md-nav__link">
    <span class="md-ellipsis">
      download_object_to_path()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.get_directory" class="md-nav__link">
    <span class="md-ellipsis">
      get_directory()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.list_objects" class="md-nav__link">
    <span class="md-ellipsis">
      list_objects()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.move_object" class="md-nav__link">
    <span class="md-ellipsis">
      move_object()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.put_directory" class="md-nav__link">
    <span class="md-ellipsis">
      put_directory()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.read_path" class="md-nav__link">
    <span class="md-ellipsis">
      read_path()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.stream_from" class="md-nav__link">
    <span class="md-ellipsis">
      stream_from()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.upload_from_file_object" class="md-nav__link">
    <span class="md-ellipsis">
      upload_from_file_object()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.upload_from_folder" class="md-nav__link">
    <span class="md-ellipsis">
      upload_from_folder()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.upload_from_path" class="md-nav__link">
    <span class="md-ellipsis">
      upload_from_path()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.write_path" class="md-nav__link">
    <span class="md-ellipsis">
      write_path()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect_aws.s3-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.s3_copy" class="md-nav__link">
    <span class="md-ellipsis">
      s3_copy()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.s3_download" class="md-nav__link">
    <span class="md-ellipsis">
      s3_download()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.s3_list_objects" class="md-nav__link">
    <span class="md-ellipsis">
      s3_list_objects()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.s3_move" class="md-nav__link">
    <span class="md-ellipsis">
      s3_move()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.s3_upload" class="md-nav__link">
    <span class="md-ellipsis">
      s3_upload()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../secrets_manager/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secrets Manager
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prefect_aws.s3-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket" class="md-nav__link">
    <span class="md-ellipsis">
      S3Bucket
    </span>
  </a>
  
    <nav class="md-nav" aria-label="S3Bucket">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.basepath" class="md-nav__link">
    <span class="md-ellipsis">
      basepath
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.bucket_folder" class="md-nav__link">
    <span class="md-ellipsis">
      bucket_folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.bucket_name" class="md-nav__link">
    <span class="md-ellipsis">
      bucket_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.credentials" class="md-nav__link">
    <span class="md-ellipsis">
      credentials
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.__json_encoder__" class="md-nav__link">
    <span class="md-ellipsis">
      __json_encoder__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.copy_object" class="md-nav__link">
    <span class="md-ellipsis">
      copy_object()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.download_folder_to_path" class="md-nav__link">
    <span class="md-ellipsis">
      download_folder_to_path()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.download_object_to_file_object" class="md-nav__link">
    <span class="md-ellipsis">
      download_object_to_file_object()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.download_object_to_path" class="md-nav__link">
    <span class="md-ellipsis">
      download_object_to_path()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.get_directory" class="md-nav__link">
    <span class="md-ellipsis">
      get_directory()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.list_objects" class="md-nav__link">
    <span class="md-ellipsis">
      list_objects()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.move_object" class="md-nav__link">
    <span class="md-ellipsis">
      move_object()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.put_directory" class="md-nav__link">
    <span class="md-ellipsis">
      put_directory()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.read_path" class="md-nav__link">
    <span class="md-ellipsis">
      read_path()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.stream_from" class="md-nav__link">
    <span class="md-ellipsis">
      stream_from()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.upload_from_file_object" class="md-nav__link">
    <span class="md-ellipsis">
      upload_from_file_object()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.upload_from_folder" class="md-nav__link">
    <span class="md-ellipsis">
      upload_from_folder()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.upload_from_path" class="md-nav__link">
    <span class="md-ellipsis">
      upload_from_path()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.S3Bucket.write_path" class="md-nav__link">
    <span class="md-ellipsis">
      write_path()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect_aws.s3-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.s3_copy" class="md-nav__link">
    <span class="md-ellipsis">
      s3_copy()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.s3_download" class="md-nav__link">
    <span class="md-ellipsis">
      s3_download()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.s3_list_objects" class="md-nav__link">
    <span class="md-ellipsis">
      s3_list_objects()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.s3_move" class="md-nav__link">
    <span class="md-ellipsis">
      s3_move()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_aws.s3.s3_upload" class="md-nav__link">
    <span class="md-ellipsis">
      s3_upload()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<div class="doc doc-object doc-module">



<h1 id="prefect_aws.s3" class="doc doc-heading">
        <code>prefect_aws.s3</code>



</h1>

    <div class="doc doc-contents first">

      <p>Tasks for interacting with AWS S3</p>



  <div class="doc doc-children">





<h2 id="prefect_aws.s3-classes">Classes</h2>

  <div class="doc doc-object doc-class">



<h3 id="prefect_aws.s3.S3Bucket" class="doc doc-heading">
        <code>
S3Bucket            (<span title="prefect.filesystems.WritableFileSystem">WritableFileSystem</span>, <span title="prefect.filesystems.WritableDeploymentStorage">WritableDeploymentStorage</span>, <span title="prefect.blocks.abstract.ObjectStorageBlock">ObjectStorageBlock</span>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Block used to store data using AWS S3 or S3-compatible object storage like MinIO.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bucket_name</code></td>
        <td><code>str</code></td>
        <td><p>Name of your bucket.</p></td>
      </tr>
      <tr>
        <td><code>credentials</code></td>
        <td><code>Union[prefect_aws.credentials.MinIOCredentials, prefect_aws.credentials.AwsCredentials]</code></td>
        <td><p>A block containing your credentials to AWS or MinIO.</p></td>
      </tr>
      <tr>
        <td><code>bucket_folder</code></td>
        <td><code>str</code></td>
        <td><p>A default path to a folder within the S3 bucket to use
for reading and writing objects.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>prefect_aws/s3.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">S3Bucket</span><span class="p">(</span><span class="n">WritableFileSystem</span><span class="p">,</span> <span class="n">WritableDeploymentStorage</span><span class="p">,</span> <span class="n">ObjectStorageBlock</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Block used to store data using AWS S3 or S3-compatible object storage like MinIO.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        bucket_name: Name of your bucket.</span>
<span class="sd">        credentials: A block containing your credentials to AWS or MinIO.</span>
<span class="sd">        bucket_folder: A default path to a folder within the S3 bucket to use</span>
<span class="sd">            for reading and writing objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_logo_url</span> <span class="o">=</span> <span class="s2">&quot;https://cdn.sanity.io/images/3ugk85nk/production/d74b16fe84ce626345adf235a47008fea2869a60-225x225.png&quot;</span>  <span class="c1"># noqa</span>
    <span class="n">_block_type_name</span> <span class="o">=</span> <span class="s2">&quot;S3 Bucket&quot;</span>
    <span class="n">_documentation_url</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;https://prefecthq.github.io/prefect-aws/s3/#prefect_aws.s3.S3Bucket&quot;</span>  <span class="c1"># noqa</span>
    <span class="p">)</span>

    <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=...</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Name of your bucket.&quot;</span><span class="p">)</span>

    <span class="n">credentials</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">MinIOCredentials</span><span class="p">,</span> <span class="n">AwsCredentials</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="n">AwsCredentials</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;A block containing your credentials to AWS or MinIO.&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">bucket_folder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;A default path to a folder within the S3 bucket to use &quot;</span>
            <span class="s2">&quot;for reading and writing objects.&quot;</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># Property to maintain compatibility with storage block based deployments</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">basepath</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The base path of the S3 bucket.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The base path of the S3 bucket.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bucket_folder</span>

    <span class="nd">@basepath</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">basepath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bucket_folder</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">_resolve_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A helper function used in write_path to join `self.basepath` and `path`.</span>

<span class="sd">        Args:</span>

<span class="sd">            path: Name of the key, e.g. &quot;file1&quot;. Each object in your</span>
<span class="sd">                bucket has a unique key (or key name).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># If bucket_folder provided, it means we won&#39;t write to the root dir of</span>
        <span class="c1"># the bucket. So we need to add it on the front of the path.</span>
        <span class="c1">#</span>
        <span class="c1"># AWS object key naming guidelines require &#39;/&#39; for bucket folders.</span>
        <span class="c1"># Get POSIX path to prevent `pathlib` from inferring &#39;\&#39; on Windows OS</span>
        <span class="n">path</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_folder</span><span class="p">)</span> <span class="o">/</span> <span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">as_posix</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bucket_folder</span> <span class="k">else</span> <span class="n">path</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">path</span>

    <span class="k">def</span> <span class="nf">_get_s3_client</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Authenticate MinIO credentials or AWS credentials and return an S3 client.</span>
<span class="sd">        This is a helper function called by read_path() or write_path().</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">get_client</span><span class="p">(</span><span class="s2">&quot;s3&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_bucket_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">boto3</span><span class="o">.</span><span class="n">resource</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves boto3 resource object for the configured bucket</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params_override</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">aws_client_parameters</span><span class="o">.</span><span class="n">get_params_override</span><span class="p">()</span>
        <span class="n">bucket</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">get_boto3_session</span><span class="p">()</span>
            <span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s2">&quot;s3&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">params_override</span><span class="p">)</span>
            <span class="o">.</span><span class="n">Bucket</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">bucket</span>

    <span class="nd">@sync_compatible</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_directory</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">from_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">local_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Copies a folder from the configured S3 bucket to a local directory.</span>

<span class="sd">        Defaults to copying the entire contents of the block&#39;s basepath to the current</span>
<span class="sd">        working directory.</span>

<span class="sd">        Args:</span>
<span class="sd">            from_path: Path in S3 bucket to download from. Defaults to the block&#39;s</span>
<span class="sd">                configured basepath.</span>
<span class="sd">            local_path: Local path to download S3 contents to. Defaults to the current</span>
<span class="sd">                working directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bucket_folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bucket_folder</span>
        <span class="k">if</span> <span class="n">from_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">from_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">bucket_folder</span><span class="p">)</span> <span class="k">if</span> <span class="n">bucket_folder</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>

        <span class="k">if</span> <span class="n">local_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">local_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">absolute</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">local_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">local_path</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">())</span>

        <span class="n">bucket</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_bucket_resource</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">bucket</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Prefix</span><span class="o">=</span><span class="n">from_path</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;/&quot;</span><span class="p">:</span>
                <span class="c1"># object is a folder and will be created if it contains any objects</span>
                <span class="k">continue</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">local_path</span><span class="p">,</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">from_path</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">target</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">bucket</span><span class="o">.</span><span class="n">download_file</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>

    <span class="nd">@sync_compatible</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">put_directory</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">local_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">to_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">ignore_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Uploads a directory from a given local path to the configured S3 bucket in a</span>
<span class="sd">        given folder.</span>

<span class="sd">        Defaults to uploading the entire contents the current working directory to the</span>
<span class="sd">        block&#39;s basepath.</span>

<span class="sd">        Args:</span>
<span class="sd">            local_path: Path to local directory to upload from.</span>
<span class="sd">            to_path: Path in S3 bucket to upload to. Defaults to block&#39;s configured</span>
<span class="sd">                basepath.</span>
<span class="sd">            ignore_file: Path to file containing gitignore style expressions for</span>
<span class="sd">                filepaths to ignore.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">to_path</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="n">to_path</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">to_path</span>

        <span class="k">if</span> <span class="n">local_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">local_path</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span>

        <span class="n">included_files</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">ignore_file</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ignore_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">ignore_patterns</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

            <span class="n">included_files</span> <span class="o">=</span> <span class="n">filter_files</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="n">ignore_patterns</span><span class="p">)</span>

        <span class="n">uploaded_file_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">local_file_path</span> <span class="ow">in</span> <span class="n">Path</span><span class="p">(</span><span class="n">local_path</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">included_files</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">local_file_path</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="n">local_path</span><span class="p">))</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">included_files</span>
            <span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">local_file_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
                <span class="n">remote_file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">to_path</span><span class="p">)</span> <span class="o">/</span> <span class="n">local_file_path</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span>
                    <span class="n">local_path</span>
                <span class="p">)</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">local_file_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">local_file</span><span class="p">:</span>
                    <span class="n">local_file_content</span> <span class="o">=</span> <span class="n">local_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_path</span><span class="p">(</span>
                    <span class="n">remote_file_path</span><span class="o">.</span><span class="n">as_posix</span><span class="p">(),</span> <span class="n">content</span><span class="o">=</span><span class="n">local_file_content</span>
                <span class="p">)</span>
                <span class="n">uploaded_file_count</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">uploaded_file_count</span>

    <span class="nd">@sync_compatible</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">read_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read specified path from S3 and return contents. Provide the entire</span>
<span class="sd">        path to the key in S3.</span>

<span class="sd">        Args:</span>
<span class="sd">            path: Entire path to (and including) the key.</span>

<span class="sd">        Example:</span>
<span class="sd">            Read &quot;subfolder/file1&quot; contents from an S3 bucket named &quot;bucket&quot;:</span>
<span class="sd">            ```python</span>
<span class="sd">            from prefect_aws import AwsCredentials</span>
<span class="sd">            from prefect_aws.s3 import S3Bucket</span>

<span class="sd">            aws_creds = AwsCredentials(</span>
<span class="sd">                aws_access_key_id=AWS_ACCESS_KEY_ID,</span>
<span class="sd">                aws_secret_access_key=AWS_SECRET_ACCESS_KEY</span>
<span class="sd">            )</span>

<span class="sd">            s3_bucket_block = S3Bucket(</span>
<span class="sd">                bucket_name=&quot;bucket&quot;,</span>
<span class="sd">                credentials=aws_creds,</span>
<span class="sd">                bucket_folder=&quot;subfolder&quot;</span>
<span class="sd">            )</span>

<span class="sd">            key_contents = s3_bucket_block.read_path(path=&quot;subfolder/file1&quot;)</span>
<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="k">return</span> <span class="k">await</span> <span class="n">run_sync_in_worker_thread</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_sync</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_sync</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Called by read_path(). Creates an S3 client and retrieves the</span>
<span class="sd">        contents from  a specified path.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">s3_client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_s3_client</span><span class="p">()</span>

        <span class="k">with</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span> <span class="k">as</span> <span class="n">stream</span><span class="p">:</span>
            <span class="n">s3_client</span><span class="o">.</span><span class="n">download_fileobj</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">Key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">Fileobj</span><span class="o">=</span><span class="n">stream</span><span class="p">)</span>
            <span class="n">stream</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">output</span>

    <span class="nd">@sync_compatible</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">write_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes to an S3 bucket.</span>

<span class="sd">        Args:</span>

<span class="sd">            path: The key name. Each object in your bucket has a unique</span>
<span class="sd">                key (or key name).</span>
<span class="sd">            content: What you are uploading to S3.</span>

<span class="sd">        Example:</span>

<span class="sd">            Write data to the path `dogs/small_dogs/havanese` in an S3 Bucket:</span>
<span class="sd">            ```python</span>
<span class="sd">            from prefect_aws import MinioCredentials</span>
<span class="sd">            from prefect_aws.s3 import S3Bucket</span>

<span class="sd">            minio_creds = MinIOCredentials(</span>
<span class="sd">                minio_root_user = &quot;minioadmin&quot;,</span>
<span class="sd">                minio_root_password = &quot;minioadmin&quot;,</span>
<span class="sd">            )</span>

<span class="sd">            s3_bucket_block = S3Bucket(</span>
<span class="sd">                bucket_name=&quot;bucket&quot;,</span>
<span class="sd">                minio_credentials=minio_creds,</span>
<span class="sd">                bucket_folder=&quot;dogs/smalldogs&quot;,</span>
<span class="sd">                endpoint_url=&quot;http://localhost:9000&quot;,</span>
<span class="sd">            )</span>
<span class="sd">            s3_havanese_path = s3_bucket_block.write_path(path=&quot;havanese&quot;, content=data)</span>
<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="k">await</span> <span class="n">run_sync_in_worker_thread</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_write_sync</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">path</span>

    <span class="k">def</span> <span class="nf">_write_sync</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Called by write_path(). Creates an S3 client and uploads a file</span>
<span class="sd">        object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">s3_client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_s3_client</span><span class="p">()</span>

        <span class="k">with</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="k">as</span> <span class="n">stream</span><span class="p">:</span>
            <span class="n">s3_client</span><span class="o">.</span><span class="n">upload_fileobj</span><span class="p">(</span><span class="n">Fileobj</span><span class="o">=</span><span class="n">stream</span><span class="p">,</span> <span class="n">Bucket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">Key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>

    <span class="c1"># NEW BLOCK INTERFACE METHODS BELOW</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_list_objects_sync</span><span class="p">(</span><span class="n">page_iterator</span><span class="p">:</span> <span class="n">PageIterator</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Synchronous method to collect S3 objects into a list</span>

<span class="sd">        Args:</span>
<span class="sd">            page_iterator: AWS Paginator for S3 objects</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[Dict]: List of object information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">content</span> <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">page_iterator</span> <span class="k">for</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Contents&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="p">]</span>

    <span class="k">def</span> <span class="nf">_join_bucket_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bucket_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Joins the base bucket folder to the bucket path.</span>
<span class="sd">        NOTE: If a method reuses another method in this class, be careful to not</span>
<span class="sd">        call this  twice because it&#39;ll join the bucket folder twice.</span>
<span class="sd">        See https://github.com/PrefectHQ/prefect-aws/issues/141 for a past issue.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">bucket_folder</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">bucket_path</span><span class="p">:</span>
            <span class="c1"># there&#39;s a difference between &quot;.&quot; and &quot;&quot;, at least in the tests</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span>

        <span class="n">bucket_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">bucket_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bucket_folder</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">bucket_path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_folder</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Bucket path </span><span class="si">{</span><span class="n">bucket_path</span><span class="si">!r}</span><span class="s2"> is already prefixed with &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;bucket folder </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_folder</span><span class="si">!r}</span><span class="s2">; is this intentional?&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_folder</span><span class="p">)</span> <span class="o">/</span> <span class="n">bucket_path</span><span class="p">)</span><span class="o">.</span><span class="n">as_posix</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span>
            <span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">bucket_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;/&quot;</span>
        <span class="p">)</span>

    <span class="nd">@sync_compatible</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">list_objects</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">folder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">delimiter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">page_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_items</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">jmespath_query</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            folder: Folder to list objects from.</span>
<span class="sd">            delimiter: Character used to group keys of listed objects.</span>
<span class="sd">            page_size: Number of objects to return in each request to the AWS API.</span>
<span class="sd">            max_items: Maximum number of objects that to be returned by task.</span>
<span class="sd">            jmespath_query: Query used to filter objects based on object attributes refer to</span>
<span class="sd">                the [boto3 docs](https://boto3.amazonaws.com/v1/documentation/api/latest/guide/paginators.html#filtering-results-with-jmespath)</span>
<span class="sd">                for more information on how to construct queries.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of objects and their metadata in the bucket.</span>

<span class="sd">        Examples:</span>
<span class="sd">            List objects under the `base_folder`.</span>
<span class="sd">            ```python</span>
<span class="sd">            from prefect_aws.s3 import S3Bucket</span>

<span class="sd">            s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>
<span class="sd">            s3_bucket.list_objects(&quot;base_folder&quot;)</span>
<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>
        <span class="n">bucket_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_join_bucket_folder</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>
        <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">get_s3_client</span><span class="p">()</span>
        <span class="n">paginator</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_paginator</span><span class="p">(</span><span class="s2">&quot;list_objects_v2&quot;</span><span class="p">)</span>
        <span class="n">page_iterator</span> <span class="o">=</span> <span class="n">paginator</span><span class="o">.</span><span class="n">paginate</span><span class="p">(</span>
            <span class="n">Bucket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="p">,</span>
            <span class="n">Prefix</span><span class="o">=</span><span class="n">bucket_path</span><span class="p">,</span>
            <span class="n">Delimiter</span><span class="o">=</span><span class="n">delimiter</span><span class="p">,</span>
            <span class="n">PaginationConfig</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;PageSize&quot;</span><span class="p">:</span> <span class="n">page_size</span><span class="p">,</span> <span class="s2">&quot;MaxItems&quot;</span><span class="p">:</span> <span class="n">max_items</span><span class="p">},</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">jmespath_query</span><span class="p">:</span>
            <span class="n">page_iterator</span> <span class="o">=</span> <span class="n">page_iterator</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">jmespath_query</span><span class="si">}</span><span class="s2"> | </span><span class="se">{{</span><span class="s2">Contents: @</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Listing objects in bucket </span><span class="si">{</span><span class="n">bucket_path</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="k">await</span> <span class="n">run_sync_in_worker_thread</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_list_objects_sync</span><span class="p">,</span> <span class="n">page_iterator</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">objects</span>

    <span class="nd">@sync_compatible</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">download_object_to_path</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">from_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">to_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]],</span>
        <span class="o">**</span><span class="n">download_kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Downloads an object from the S3 bucket to a path.</span>

<span class="sd">        Args:</span>
<span class="sd">            from_path: The path to the object to download; this gets prefixed</span>
<span class="sd">                with the bucket_folder.</span>
<span class="sd">            to_path: The path to download the object to. If not provided, the</span>
<span class="sd">                object&#39;s name will be used.</span>
<span class="sd">            **download_kwargs: Additional keyword arguments to pass to</span>
<span class="sd">                `Client.download_file`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The absolute path that the object was downloaded to.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Download my_folder/notes.txt object to notes.txt.</span>
<span class="sd">            ```python</span>
<span class="sd">            from prefect_aws.s3 import S3Bucket</span>

<span class="sd">            s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>
<span class="sd">            s3_bucket.download_object_to_path(&quot;my_folder/notes.txt&quot;, &quot;notes.txt&quot;)</span>
<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">to_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">to_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">from_path</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>

        <span class="c1"># making path absolute, but converting back to str here</span>
        <span class="c1"># since !r looks nicer that way and filename arg expects str</span>
        <span class="n">to_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">to_path</span><span class="p">)</span><span class="o">.</span><span class="n">absolute</span><span class="p">())</span>
        <span class="n">bucket_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_join_bucket_folder</span><span class="p">(</span><span class="n">from_path</span><span class="p">)</span>
        <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">get_s3_client</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Preparing to download object from bucket </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="si">!r}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;path </span><span class="si">{</span><span class="n">bucket_path</span><span class="si">!r}</span><span class="s2"> to </span><span class="si">{</span><span class="n">to_path</span><span class="si">!r}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
        <span class="k">await</span> <span class="n">run_sync_in_worker_thread</span><span class="p">(</span>
            <span class="n">client</span><span class="o">.</span><span class="n">download_file</span><span class="p">,</span>
            <span class="n">Bucket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="p">,</span>
            <span class="n">Key</span><span class="o">=</span><span class="n">from_path</span><span class="p">,</span>
            <span class="n">Filename</span><span class="o">=</span><span class="n">to_path</span><span class="p">,</span>
            <span class="o">**</span><span class="n">download_kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Downloaded object from bucket </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="si">!r}</span><span class="s2"> path </span><span class="si">{</span><span class="n">bucket_path</span><span class="si">!r}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;to </span><span class="si">{</span><span class="n">to_path</span><span class="si">!r}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">to_path</span><span class="p">)</span>

    <span class="nd">@sync_compatible</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">download_object_to_file_object</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">from_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">to_file_object</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">,</span>
        <span class="o">**</span><span class="n">download_kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BinaryIO</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Downloads an object from the object storage service to a file-like object,</span>
<span class="sd">        which can be a BytesIO object or a BufferedWriter.</span>

<span class="sd">        Args:</span>
<span class="sd">            from_path: The path to the object to download from; this gets prefixed</span>
<span class="sd">                with the bucket_folder.</span>
<span class="sd">            to_file_object: The file-like object to download the object to.</span>
<span class="sd">            **download_kwargs: Additional keyword arguments to pass to</span>
<span class="sd">                `Client.download_fileobj`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The file-like object that the object was downloaded to.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Download my_folder/notes.txt object to a BytesIO object.</span>
<span class="sd">            ```python</span>
<span class="sd">            from io import BytesIO</span>

<span class="sd">            from prefect_aws.s3 import S3Bucket</span>

<span class="sd">            s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>
<span class="sd">            with BytesIO() as buf:</span>
<span class="sd">                s3_bucket.download_object_to_file_object(&quot;my_folder/notes.txt&quot;, buf)</span>
<span class="sd">            ```</span>

<span class="sd">            Download my_folder/notes.txt object to a BufferedWriter.</span>
<span class="sd">            ```python</span>
<span class="sd">            from prefect_aws.s3 import S3Bucket</span>

<span class="sd">            s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>
<span class="sd">            with open(&quot;notes.txt&quot;, &quot;wb&quot;) as f:</span>
<span class="sd">                s3_bucket.download_object_to_file_object(&quot;my_folder/notes.txt&quot;, f)</span>
<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">get_s3_client</span><span class="p">()</span>
        <span class="n">bucket_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_join_bucket_folder</span><span class="p">(</span><span class="n">from_path</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Preparing to download object from bucket </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="si">!r}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;path </span><span class="si">{</span><span class="n">bucket_path</span><span class="si">!r}</span><span class="s2"> to file object.&quot;</span>
        <span class="p">)</span>
        <span class="k">await</span> <span class="n">run_sync_in_worker_thread</span><span class="p">(</span>
            <span class="n">client</span><span class="o">.</span><span class="n">download_fileobj</span><span class="p">,</span>
            <span class="n">Bucket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="p">,</span>
            <span class="n">Key</span><span class="o">=</span><span class="n">bucket_path</span><span class="p">,</span>
            <span class="n">Fileobj</span><span class="o">=</span><span class="n">to_file_object</span><span class="p">,</span>
            <span class="o">**</span><span class="n">download_kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Downloaded object from bucket </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="si">!r}</span><span class="s2"> path </span><span class="si">{</span><span class="n">bucket_path</span><span class="si">!r}</span><span class="s2"> &quot;</span>
            <span class="s2">&quot;to file object.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">to_file_object</span>

    <span class="nd">@sync_compatible</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">download_folder_to_path</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">from_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">to_folder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">download_kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Downloads objects *within* a folder (excluding the folder itself)</span>
<span class="sd">        from the S3 bucket to a folder.</span>

<span class="sd">        Args:</span>
<span class="sd">            from_folder: The path to the folder to download from.</span>
<span class="sd">            to_folder: The path to download the folder to.</span>
<span class="sd">            **download_kwargs: Additional keyword arguments to pass to</span>
<span class="sd">                `Client.download_file`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The absolute path that the folder was downloaded to.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Download my_folder to a local folder named my_folder.</span>
<span class="sd">            ```python</span>
<span class="sd">            from prefect_aws.s3 import S3Bucket</span>

<span class="sd">            s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>
<span class="sd">            s3_bucket.download_folder_to_path(&quot;my_folder&quot;, &quot;my_folder&quot;)</span>
<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">to_folder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">to_folder</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">to_folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">to_folder</span><span class="p">)</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>

        <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">get_s3_client</span><span class="p">()</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_objects</span><span class="p">(</span><span class="n">folder</span><span class="o">=</span><span class="n">from_folder</span><span class="p">)</span>

        <span class="c1"># do not call self._join_bucket_folder for filter</span>
        <span class="c1"># because it&#39;s built-in to that method already!</span>
        <span class="c1"># however, we still need to do it because we&#39;re using relative_to</span>
        <span class="n">bucket_folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_join_bucket_folder</span><span class="p">(</span><span class="n">from_folder</span><span class="p">)</span>

        <span class="n">async_coros</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="nb">object</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
            <span class="n">bucket_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="nb">object</span><span class="p">[</span><span class="s2">&quot;Key&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="n">bucket_folder</span><span class="p">)</span>
            <span class="c1"># this skips the actual directory itself, e.g.</span>
            <span class="c1"># `my_folder/` will be skipped</span>
            <span class="c1"># `my_folder/notes.txt` will be downloaded</span>
            <span class="k">if</span> <span class="n">bucket_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
                <span class="k">continue</span>
            <span class="n">to_path</span> <span class="o">=</span> <span class="n">to_folder</span> <span class="o">/</span> <span class="n">bucket_path</span>
            <span class="n">to_path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">to_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">to_path</span><span class="p">)</span>  <span class="c1"># must be string</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Downloading object from bucket </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="si">!r}</span><span class="s2"> path &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bucket_path</span><span class="o">.</span><span class="n">as_posix</span><span class="p">()</span><span class="si">!r}</span><span class="s2"> to </span><span class="si">{</span><span class="n">to_path</span><span class="si">!r}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
            <span class="n">async_coros</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">run_sync_in_worker_thread</span><span class="p">(</span>
                    <span class="n">client</span><span class="o">.</span><span class="n">download_file</span><span class="p">,</span>
                    <span class="n">Bucket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="p">,</span>
                    <span class="n">Key</span><span class="o">=</span><span class="nb">object</span><span class="p">[</span><span class="s2">&quot;Key&quot;</span><span class="p">],</span>
                    <span class="n">Filename</span><span class="o">=</span><span class="n">to_path</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">download_kwargs</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">async_coros</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">to_folder</span><span class="p">)</span>

    <span class="nd">@sync_compatible</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">stream_from</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">bucket</span><span class="p">:</span> <span class="s2">&quot;S3Bucket&quot;</span><span class="p">,</span>
        <span class="n">from_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">to_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">upload_kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Streams an object from another bucket to this bucket. Requires the</span>
<span class="sd">        object to be downloaded and uploaded in chunks. If `self`&#39;s credentials</span>
<span class="sd">        allow for writes to the other bucket, try using `S3Bucket.copy_object`.</span>

<span class="sd">        Args:</span>
<span class="sd">            bucket: The bucket to stream from.</span>
<span class="sd">            from_path: The path of the object to stream.</span>
<span class="sd">            to_path: The path to stream the object to. Defaults to the object&#39;s name.</span>
<span class="sd">            **upload_kwargs: Additional keyword arguments to pass to</span>
<span class="sd">                `Client.upload_fileobj`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The path that the object was uploaded to.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Stream notes.txt from your-bucket/notes.txt to my-bucket/landed/notes.txt.</span>

<span class="sd">            ```python</span>
<span class="sd">            from prefect_aws.s3 import S3Bucket</span>

<span class="sd">            your_s3_bucket = S3Bucket.load(&quot;your-bucket&quot;)</span>
<span class="sd">            my_s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>

<span class="sd">            my_s3_bucket.stream_from(</span>
<span class="sd">                your_s3_bucket,</span>
<span class="sd">                &quot;notes.txt&quot;,</span>
<span class="sd">                to_path=&quot;landed/notes.txt&quot;</span>
<span class="sd">            )</span>
<span class="sd">            ```</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">to_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">to_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">from_path</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>

        <span class="c1"># Get the source object&#39;s StreamingBody</span>
        <span class="n">from_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">bucket</span><span class="o">.</span><span class="n">_join_bucket_folder</span><span class="p">(</span><span class="n">from_path</span><span class="p">)</span>
        <span class="n">from_client</span> <span class="o">=</span> <span class="n">bucket</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">get_s3_client</span><span class="p">()</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="k">await</span> <span class="n">run_sync_in_worker_thread</span><span class="p">(</span>
            <span class="n">from_client</span><span class="o">.</span><span class="n">get_object</span><span class="p">,</span> <span class="n">Bucket</span><span class="o">=</span><span class="n">bucket</span><span class="o">.</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">Key</span><span class="o">=</span><span class="n">from_path</span>
        <span class="p">)</span>
        <span class="n">body</span><span class="p">:</span> <span class="n">StreamingBody</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;Body&quot;</span><span class="p">]</span>

        <span class="c1"># Upload the StreamingBody to this bucket</span>
        <span class="n">bucket_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_join_bucket_folder</span><span class="p">(</span><span class="n">to_path</span><span class="p">))</span>
        <span class="n">to_client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">get_s3_client</span><span class="p">()</span>
        <span class="k">await</span> <span class="n">run_sync_in_worker_thread</span><span class="p">(</span>
            <span class="n">to_client</span><span class="o">.</span><span class="n">upload_fileobj</span><span class="p">,</span>
            <span class="n">Fileobj</span><span class="o">=</span><span class="n">body</span><span class="p">,</span>
            <span class="n">Bucket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="p">,</span>
            <span class="n">Key</span><span class="o">=</span><span class="n">bucket_path</span><span class="p">,</span>
            <span class="o">**</span><span class="n">upload_kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Streamed s3://</span><span class="si">{</span><span class="n">bucket</span><span class="o">.</span><span class="n">bucket_name</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">from_path</span><span class="si">}</span><span class="s2"> to the bucket &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="si">!r}</span><span class="s2"> path </span><span class="si">{</span><span class="n">bucket_path</span><span class="si">!r}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">bucket_path</span>

    <span class="nd">@sync_compatible</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">upload_from_path</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">from_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
        <span class="n">to_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">upload_kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Uploads an object from a path to the S3 bucket.</span>

<span class="sd">        Args:</span>
<span class="sd">            from_path: The path to the file to upload from.</span>
<span class="sd">            to_path: The path to upload the file to.</span>
<span class="sd">            **upload_kwargs: Additional keyword arguments to pass to `Client.upload`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The path that the object was uploaded to.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Upload notes.txt to my_folder/notes.txt.</span>
<span class="sd">            ```python</span>
<span class="sd">            from prefect_aws.s3 import S3Bucket</span>

<span class="sd">            s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>
<span class="sd">            s3_bucket.upload_from_path(&quot;notes.txt&quot;, &quot;my_folder/notes.txt&quot;)</span>
<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">from_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">from_path</span><span class="p">)</span><span class="o">.</span><span class="n">absolute</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">to_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">to_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">from_path</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>

        <span class="n">bucket_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_join_bucket_folder</span><span class="p">(</span><span class="n">to_path</span><span class="p">))</span>
        <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">get_s3_client</span><span class="p">()</span>

        <span class="k">await</span> <span class="n">run_sync_in_worker_thread</span><span class="p">(</span>
            <span class="n">client</span><span class="o">.</span><span class="n">upload_file</span><span class="p">,</span>
            <span class="n">Filename</span><span class="o">=</span><span class="n">from_path</span><span class="p">,</span>
            <span class="n">Bucket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="p">,</span>
            <span class="n">Key</span><span class="o">=</span><span class="n">bucket_path</span><span class="p">,</span>
            <span class="o">**</span><span class="n">upload_kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Uploaded from </span><span class="si">{</span><span class="n">from_path</span><span class="si">!r}</span><span class="s2"> to the bucket &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="si">!r}</span><span class="s2"> path </span><span class="si">{</span><span class="n">bucket_path</span><span class="si">!r}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">bucket_path</span>

    <span class="nd">@sync_compatible</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">upload_from_file_object</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">from_file_object</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">,</span> <span class="n">to_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">upload_kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Uploads an object to the S3 bucket from a file-like object,</span>
<span class="sd">        which can be a BytesIO object or a BufferedReader.</span>

<span class="sd">        Args:</span>
<span class="sd">            from_file_object: The file-like object to upload from.</span>
<span class="sd">            to_path: The path to upload the object to.</span>
<span class="sd">            **upload_kwargs: Additional keyword arguments to pass to</span>
<span class="sd">                `Client.upload_fileobj`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The path that the object was uploaded to.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Upload BytesIO object to my_folder/notes.txt.</span>
<span class="sd">            ```python</span>
<span class="sd">            from io import BytesIO</span>

<span class="sd">            from prefect_aws.s3 import S3Bucket</span>

<span class="sd">            s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>
<span class="sd">            with open(&quot;notes.txt&quot;, &quot;rb&quot;) as f:</span>
<span class="sd">                s3_bucket.upload_from_file_object(f, &quot;my_folder/notes.txt&quot;)</span>
<span class="sd">            ```</span>

<span class="sd">            Upload BufferedReader object to my_folder/notes.txt.</span>
<span class="sd">            ```python</span>
<span class="sd">            from prefect_aws.s3 import S3Bucket</span>

<span class="sd">            s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>
<span class="sd">            with open(&quot;notes.txt&quot;, &quot;rb&quot;) as f:</span>
<span class="sd">                s3_bucket.upload_from_file_object(</span>
<span class="sd">                    f, &quot;my_folder/notes.txt&quot;</span>
<span class="sd">                )</span>
<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bucket_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_join_bucket_folder</span><span class="p">(</span><span class="n">to_path</span><span class="p">))</span>
        <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">get_s3_client</span><span class="p">()</span>
        <span class="k">await</span> <span class="n">run_sync_in_worker_thread</span><span class="p">(</span>
            <span class="n">client</span><span class="o">.</span><span class="n">upload_fileobj</span><span class="p">,</span>
            <span class="n">Fileobj</span><span class="o">=</span><span class="n">from_file_object</span><span class="p">,</span>
            <span class="n">Bucket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="p">,</span>
            <span class="n">Key</span><span class="o">=</span><span class="n">bucket_path</span><span class="p">,</span>
            <span class="o">**</span><span class="n">upload_kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Uploaded from file object to the bucket &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="si">!r}</span><span class="s2"> path </span><span class="si">{</span><span class="n">bucket_path</span><span class="si">!r}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">bucket_path</span>

    <span class="nd">@sync_compatible</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">upload_from_folder</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">from_folder</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
        <span class="n">to_folder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">upload_kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Uploads files *within* a folder (excluding the folder itself)</span>
<span class="sd">        to the object storage service folder.</span>

<span class="sd">        Args:</span>
<span class="sd">            from_folder: The path to the folder to upload from.</span>
<span class="sd">            to_folder: The path to upload the folder to.</span>
<span class="sd">            **upload_kwargs: Additional keyword arguments to pass to</span>
<span class="sd">                `Client.upload_fileobj`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The path that the folder was uploaded to.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Upload contents from my_folder to new_folder.</span>
<span class="sd">            ```python</span>
<span class="sd">            from prefect_aws.s3 import S3Bucket</span>

<span class="sd">            s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>
<span class="sd">            s3_bucket.upload_from_folder(&quot;my_folder&quot;, &quot;new_folder&quot;)</span>
<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">from_folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">from_folder</span><span class="p">)</span>
        <span class="n">bucket_folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_join_bucket_folder</span><span class="p">(</span><span class="n">to_folder</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="n">num_uploaded</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">get_s3_client</span><span class="p">()</span>

        <span class="n">async_coros</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">from_path</span> <span class="ow">in</span> <span class="n">from_folder</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;**/*&quot;</span><span class="p">):</span>
            <span class="c1"># this skips the actual directory itself, e.g.</span>
            <span class="c1"># `my_folder/` will be skipped</span>
            <span class="c1"># `my_folder/notes.txt` will be uploaded</span>
            <span class="k">if</span> <span class="n">from_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
                <span class="k">continue</span>
            <span class="n">bucket_path</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">Path</span><span class="p">(</span><span class="n">bucket_folder</span><span class="p">)</span> <span class="o">/</span> <span class="n">from_path</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="n">from_folder</span><span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">as_posix</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Uploading from </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">from_path</span><span class="p">)</span><span class="si">!r}</span><span class="s2"> to the bucket &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="si">!r}</span><span class="s2"> path </span><span class="si">{</span><span class="n">bucket_path</span><span class="si">!r}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
            <span class="n">async_coros</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">run_sync_in_worker_thread</span><span class="p">(</span>
                    <span class="n">client</span><span class="o">.</span><span class="n">upload_file</span><span class="p">,</span>
                    <span class="n">Filename</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">from_path</span><span class="p">),</span>
                    <span class="n">Bucket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="p">,</span>
                    <span class="n">Key</span><span class="o">=</span><span class="n">bucket_path</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">upload_kwargs</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">num_uploaded</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">async_coros</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">num_uploaded</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No files were uploaded from </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">from_folder</span><span class="p">)</span><span class="si">!r}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Uploaded </span><span class="si">{</span><span class="n">num_uploaded</span><span class="si">}</span><span class="s2"> files from </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">from_folder</span><span class="p">)</span><span class="si">!r}</span><span class="s2"> to &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;the bucket </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="si">!r}</span><span class="s2"> path </span><span class="si">{</span><span class="n">bucket_path</span><span class="si">!r}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">to_folder</span>

    <span class="nd">@sync_compatible</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">copy_object</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">from_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
        <span class="n">to_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
        <span class="n">to_bucket</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;S3Bucket&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">copy_kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Uses S3&#39;s internal</span>
<span class="sd">        [CopyObject](https://docs.aws.amazon.com/AmazonS3/latest/API/API_CopyObject.html)</span>
<span class="sd">        to copy objects within or between buckets. To copy objects between buckets,</span>
<span class="sd">        `self`&#39;s credentials must have permission to read the source object and write</span>
<span class="sd">        to the target object. If the credentials do not have those permissions, try</span>
<span class="sd">        using `S3Bucket.stream_from`.</span>

<span class="sd">        Args:</span>
<span class="sd">            from_path: The path of the object to copy.</span>
<span class="sd">            to_path: The path to copy the object to.</span>
<span class="sd">            to_bucket: The bucket to copy to. Defaults to the current bucket.</span>
<span class="sd">            **copy_kwargs: Additional keyword arguments to pass to</span>
<span class="sd">                `S3Client.copy_object`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The path that the object was copied to. Excludes the bucket name.</span>

<span class="sd">        Examples:</span>

<span class="sd">            Copy notes.txt from my_folder/notes.txt to my_folder/notes_copy.txt.</span>

<span class="sd">            ```python</span>
<span class="sd">            from prefect_aws.s3 import S3Bucket</span>

<span class="sd">            s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>
<span class="sd">            s3_bucket.copy_object(&quot;my_folder/notes.txt&quot;, &quot;my_folder/notes_copy.txt&quot;)</span>
<span class="sd">            ```</span>

<span class="sd">            Copy notes.txt from my_folder/notes.txt to my_folder/notes_copy.txt in</span>
<span class="sd">            another bucket.</span>

<span class="sd">            ```python</span>
<span class="sd">            from prefect_aws.s3 import S3Bucket</span>

<span class="sd">            s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>
<span class="sd">            s3_bucket.copy_object(</span>
<span class="sd">                &quot;my_folder/notes.txt&quot;,</span>
<span class="sd">                &quot;my_folder/notes_copy.txt&quot;,</span>
<span class="sd">                to_bucket=&quot;other-bucket&quot;</span>
<span class="sd">            )</span>
<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s3_client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">get_s3_client</span><span class="p">()</span>

        <span class="n">source_bucket_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span>
        <span class="n">source_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_path</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">from_path</span><span class="p">)</span><span class="o">.</span><span class="n">as_posix</span><span class="p">())</span>

        <span class="c1"># Default to copying within the same bucket</span>
        <span class="n">to_bucket</span> <span class="o">=</span> <span class="n">to_bucket</span> <span class="ow">or</span> <span class="bp">self</span>

        <span class="n">target_bucket_name</span><span class="p">:</span> <span class="nb">str</span>
        <span class="n">target_path</span><span class="p">:</span> <span class="nb">str</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to_bucket</span><span class="p">,</span> <span class="n">S3Bucket</span><span class="p">):</span>
            <span class="n">target_bucket_name</span> <span class="o">=</span> <span class="n">to_bucket</span><span class="o">.</span><span class="n">bucket_name</span>
            <span class="n">target_path</span> <span class="o">=</span> <span class="n">to_bucket</span><span class="o">.</span><span class="n">_resolve_path</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">to_path</span><span class="p">)</span><span class="o">.</span><span class="n">as_posix</span><span class="p">())</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to_bucket</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">target_bucket_name</span> <span class="o">=</span> <span class="n">to_bucket</span>
            <span class="n">target_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">to_path</span><span class="p">)</span><span class="o">.</span><span class="n">as_posix</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;to_bucket must be a string or S3Bucket, not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">to_bucket</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Copying object from bucket </span><span class="si">%s</span><span class="s2"> with key </span><span class="si">%s</span><span class="s2"> to bucket </span><span class="si">%s</span><span class="s2"> with key </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">source_bucket_name</span><span class="p">,</span>
            <span class="n">source_path</span><span class="p">,</span>
            <span class="n">target_bucket_name</span><span class="p">,</span>
            <span class="n">target_path</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">s3_client</span><span class="o">.</span><span class="n">copy_object</span><span class="p">(</span>
            <span class="n">CopySource</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Bucket&quot;</span><span class="p">:</span> <span class="n">source_bucket_name</span><span class="p">,</span> <span class="s2">&quot;Key&quot;</span><span class="p">:</span> <span class="n">source_path</span><span class="p">},</span>
            <span class="n">Bucket</span><span class="o">=</span><span class="n">target_bucket_name</span><span class="p">,</span>
            <span class="n">Key</span><span class="o">=</span><span class="n">target_path</span><span class="p">,</span>
            <span class="o">**</span><span class="n">copy_kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">target_path</span>

    <span class="nd">@sync_compatible</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">move_object</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">from_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
        <span class="n">to_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
        <span class="n">to_bucket</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;S3Bucket&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Uses S3&#39;s internal CopyObject and DeleteObject to move objects within or</span>
<span class="sd">        between buckets. To move objects between buckets, `self`&#39;s credentials must</span>
<span class="sd">        have permission to read and delete the source object and write to the target</span>
<span class="sd">        object. If the credentials do not have those permissions, this method will</span>
<span class="sd">        raise an error. If the credentials have permission to read the source object</span>
<span class="sd">        but not delete it, the object will be copied but not deleted.</span>

<span class="sd">        Args:</span>
<span class="sd">            from_path: The path of the object to move.</span>
<span class="sd">            to_path: The path to move the object to.</span>
<span class="sd">            to_bucket: The bucket to move to. Defaults to the current bucket.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The path that the object was moved to. Excludes the bucket name.</span>

<span class="sd">        Examples:</span>

<span class="sd">            Move notes.txt from my_folder/notes.txt to my_folder/notes_copy.txt.</span>

<span class="sd">            ```python</span>
<span class="sd">            from prefect_aws.s3 import S3Bucket</span>

<span class="sd">            s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>
<span class="sd">            s3_bucket.move_object(&quot;my_folder/notes.txt&quot;, &quot;my_folder/notes_copy.txt&quot;)</span>
<span class="sd">            ```</span>

<span class="sd">            Move notes.txt from my_folder/notes.txt to my_folder/notes_copy.txt in</span>
<span class="sd">            another bucket.</span>

<span class="sd">            ```python</span>
<span class="sd">            from prefect_aws.s3 import S3Bucket</span>

<span class="sd">            s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>
<span class="sd">            s3_bucket.move_object(</span>
<span class="sd">                &quot;my_folder/notes.txt&quot;,</span>
<span class="sd">                &quot;my_folder/notes_copy.txt&quot;,</span>
<span class="sd">                to_bucket=&quot;other-bucket&quot;</span>
<span class="sd">            )</span>
<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s3_client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">get_s3_client</span><span class="p">()</span>

        <span class="n">source_bucket_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span>
        <span class="n">source_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_path</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">from_path</span><span class="p">)</span><span class="o">.</span><span class="n">as_posix</span><span class="p">())</span>

        <span class="c1"># Default to moving within the same bucket</span>
        <span class="n">to_bucket</span> <span class="o">=</span> <span class="n">to_bucket</span> <span class="ow">or</span> <span class="bp">self</span>

        <span class="n">target_bucket_name</span><span class="p">:</span> <span class="nb">str</span>
        <span class="n">target_path</span><span class="p">:</span> <span class="nb">str</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to_bucket</span><span class="p">,</span> <span class="n">S3Bucket</span><span class="p">):</span>
            <span class="n">target_bucket_name</span> <span class="o">=</span> <span class="n">to_bucket</span><span class="o">.</span><span class="n">bucket_name</span>
            <span class="n">target_path</span> <span class="o">=</span> <span class="n">to_bucket</span><span class="o">.</span><span class="n">_resolve_path</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">to_path</span><span class="p">)</span><span class="o">.</span><span class="n">as_posix</span><span class="p">())</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to_bucket</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">target_bucket_name</span> <span class="o">=</span> <span class="n">to_bucket</span>
            <span class="n">target_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">to_path</span><span class="p">)</span><span class="o">.</span><span class="n">as_posix</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;to_bucket must be a string or S3Bucket, not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">to_bucket</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Moving object from s3://</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2"> to s3://</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">source_bucket_name</span><span class="p">,</span>
            <span class="n">source_path</span><span class="p">,</span>
            <span class="n">target_bucket_name</span><span class="p">,</span>
            <span class="n">target_path</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># If invalid, should error and prevent next operation</span>
        <span class="n">s3_client</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span>
            <span class="n">CopySource</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Bucket&quot;</span><span class="p">:</span> <span class="n">source_bucket_name</span><span class="p">,</span> <span class="s2">&quot;Key&quot;</span><span class="p">:</span> <span class="n">source_path</span><span class="p">},</span>
            <span class="n">Bucket</span><span class="o">=</span><span class="n">target_bucket_name</span><span class="p">,</span>
            <span class="n">Key</span><span class="o">=</span><span class="n">target_path</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">s3_client</span><span class="o">.</span><span class="n">delete_object</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="n">source_bucket_name</span><span class="p">,</span> <span class="n">Key</span><span class="o">=</span><span class="n">source_path</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">target_path</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">




<h4 id="prefect_aws.s3.S3Bucket-attributes">Attributes</h4>














  <div class="doc doc-object doc-attribute">



<h5 id="prefect_aws.s3.S3Bucket.basepath" class="doc doc-heading">
<code class="highlight language-python"><span class="n">basepath</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-writable"><code>writable</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>The base path of the S3 bucket.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The base path of the S3 bucket.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="prefect_aws.s3.S3Bucket.bucket_folder" class="doc doc-heading">
<code class="highlight language-python"><span class="n">bucket_folder</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>A default path to a folder within the S3 bucket to use for reading and writing objects.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="prefect_aws.s3.S3Bucket.bucket_name" class="doc doc-heading">
<code class="highlight language-python"><span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Name of your bucket.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="prefect_aws.s3.S3Bucket.credentials" class="doc doc-heading">
<code class="highlight language-python"><span class="n">credentials</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">prefect_aws</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">MinIOCredentials</span><span class="p">,</span> <span class="n">prefect_aws</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">AwsCredentials</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>A block containing your credentials to AWS or MinIO.</p>
    </div>

  </div>





<h4 id="prefect_aws.s3.S3Bucket-methods">Methods</h4>

  <div class="doc doc-object doc-method">



<h5 id="prefect_aws.s3.S3Bucket.__json_encoder__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">__json_encoder__</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>partial(func, <em>args, </em>*keywords) - new function with partial application
of the given arguments and keywords.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="prefect_aws.s3.S3Bucket.copy_object" class="doc doc-heading">
<code class="highlight language-python"><span class="n">copy_object</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Uses S3's internal
<a href="https://docs.aws.amazon.com/AmazonS3/latest/API/API_CopyObject.html">CopyObject</a>
to copy objects within or between buckets. To copy objects between buckets,
<code>self</code>'s credentials must have permission to read the source object and write
to the target object. If the credentials do not have those permissions, try
using <code>S3Bucket.stream_from</code>.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>from_path</code></td>
        <td><code>Union[str, pathlib.Path]</code></td>
        <td><p>The path of the object to copy.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>to_path</code></td>
        <td><code>Union[str, pathlib.Path]</code></td>
        <td><p>The path to copy the object to.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>to_bucket</code></td>
        <td><code>Union[S3Bucket, str]</code></td>
        <td><p>The bucket to copy to. Defaults to the current bucket.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>**copy_kwargs</code></td>
        <td></td>
        <td><p>Additional keyword arguments to pass to
<code>S3Client.copy_object</code>.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The path that the object was copied to. Excludes the bucket name.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <p>Copy notes.txt from my_folder/notes.txt to my_folder/notes_copy.txt.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect_aws.s3</span> <span class="kn">import</span> <span class="n">S3Bucket</span>

<span class="n">s3_bucket</span> <span class="o">=</span> <span class="n">S3Bucket</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;my-bucket&quot;</span><span class="p">)</span>
<span class="n">s3_bucket</span><span class="o">.</span><span class="n">copy_object</span><span class="p">(</span><span class="s2">&quot;my_folder/notes.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;my_folder/notes_copy.txt&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Copy notes.txt from my_folder/notes.txt to my_folder/notes_copy.txt in
another bucket.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect_aws.s3</span> <span class="kn">import</span> <span class="n">S3Bucket</span>

<span class="n">s3_bucket</span> <span class="o">=</span> <span class="n">S3Bucket</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;my-bucket&quot;</span><span class="p">)</span>
<span class="n">s3_bucket</span><span class="o">.</span><span class="n">copy_object</span><span class="p">(</span>
    <span class="s2">&quot;my_folder/notes.txt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;my_folder/notes_copy.txt&quot;</span><span class="p">,</span>
    <span class="n">to_bucket</span><span class="o">=</span><span class="s2">&quot;other-bucket&quot;</span>
<span class="p">)</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>prefect_aws/s3.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@sync_compatible</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">copy_object</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">from_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
    <span class="n">to_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
    <span class="n">to_bucket</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;S3Bucket&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">copy_kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Uses S3&#39;s internal</span>
<span class="sd">    [CopyObject](https://docs.aws.amazon.com/AmazonS3/latest/API/API_CopyObject.html)</span>
<span class="sd">    to copy objects within or between buckets. To copy objects between buckets,</span>
<span class="sd">    `self`&#39;s credentials must have permission to read the source object and write</span>
<span class="sd">    to the target object. If the credentials do not have those permissions, try</span>
<span class="sd">    using `S3Bucket.stream_from`.</span>

<span class="sd">    Args:</span>
<span class="sd">        from_path: The path of the object to copy.</span>
<span class="sd">        to_path: The path to copy the object to.</span>
<span class="sd">        to_bucket: The bucket to copy to. Defaults to the current bucket.</span>
<span class="sd">        **copy_kwargs: Additional keyword arguments to pass to</span>
<span class="sd">            `S3Client.copy_object`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The path that the object was copied to. Excludes the bucket name.</span>

<span class="sd">    Examples:</span>

<span class="sd">        Copy notes.txt from my_folder/notes.txt to my_folder/notes_copy.txt.</span>

<span class="sd">        ```python</span>
<span class="sd">        from prefect_aws.s3 import S3Bucket</span>

<span class="sd">        s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>
<span class="sd">        s3_bucket.copy_object(&quot;my_folder/notes.txt&quot;, &quot;my_folder/notes_copy.txt&quot;)</span>
<span class="sd">        ```</span>

<span class="sd">        Copy notes.txt from my_folder/notes.txt to my_folder/notes_copy.txt in</span>
<span class="sd">        another bucket.</span>

<span class="sd">        ```python</span>
<span class="sd">        from prefect_aws.s3 import S3Bucket</span>

<span class="sd">        s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>
<span class="sd">        s3_bucket.copy_object(</span>
<span class="sd">            &quot;my_folder/notes.txt&quot;,</span>
<span class="sd">            &quot;my_folder/notes_copy.txt&quot;,</span>
<span class="sd">            to_bucket=&quot;other-bucket&quot;</span>
<span class="sd">        )</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s3_client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">get_s3_client</span><span class="p">()</span>

    <span class="n">source_bucket_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span>
    <span class="n">source_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_path</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">from_path</span><span class="p">)</span><span class="o">.</span><span class="n">as_posix</span><span class="p">())</span>

    <span class="c1"># Default to copying within the same bucket</span>
    <span class="n">to_bucket</span> <span class="o">=</span> <span class="n">to_bucket</span> <span class="ow">or</span> <span class="bp">self</span>

    <span class="n">target_bucket_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">target_path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to_bucket</span><span class="p">,</span> <span class="n">S3Bucket</span><span class="p">):</span>
        <span class="n">target_bucket_name</span> <span class="o">=</span> <span class="n">to_bucket</span><span class="o">.</span><span class="n">bucket_name</span>
        <span class="n">target_path</span> <span class="o">=</span> <span class="n">to_bucket</span><span class="o">.</span><span class="n">_resolve_path</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">to_path</span><span class="p">)</span><span class="o">.</span><span class="n">as_posix</span><span class="p">())</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to_bucket</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">target_bucket_name</span> <span class="o">=</span> <span class="n">to_bucket</span>
        <span class="n">target_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">to_path</span><span class="p">)</span><span class="o">.</span><span class="n">as_posix</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;to_bucket must be a string or S3Bucket, not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">to_bucket</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="s2">&quot;Copying object from bucket </span><span class="si">%s</span><span class="s2"> with key </span><span class="si">%s</span><span class="s2"> to bucket </span><span class="si">%s</span><span class="s2"> with key </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">source_bucket_name</span><span class="p">,</span>
        <span class="n">source_path</span><span class="p">,</span>
        <span class="n">target_bucket_name</span><span class="p">,</span>
        <span class="n">target_path</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">s3_client</span><span class="o">.</span><span class="n">copy_object</span><span class="p">(</span>
        <span class="n">CopySource</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Bucket&quot;</span><span class="p">:</span> <span class="n">source_bucket_name</span><span class="p">,</span> <span class="s2">&quot;Key&quot;</span><span class="p">:</span> <span class="n">source_path</span><span class="p">},</span>
        <span class="n">Bucket</span><span class="o">=</span><span class="n">target_bucket_name</span><span class="p">,</span>
        <span class="n">Key</span><span class="o">=</span><span class="n">target_path</span><span class="p">,</span>
        <span class="o">**</span><span class="n">copy_kwargs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">target_path</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="prefect_aws.s3.S3Bucket.download_folder_to_path" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download_folder_to_path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Downloads objects <em>within</em> a folder (excluding the folder itself)
from the S3 bucket to a folder.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>from_folder</code></td>
        <td><code>str</code></td>
        <td><p>The path to the folder to download from.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>to_folder</code></td>
        <td><code>Union[str, pathlib.Path]</code></td>
        <td><p>The path to download the folder to.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>**download_kwargs</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>Additional keyword arguments to pass to
<code>Client.download_file</code>.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Path</code></td>
      <td><p>The absolute path that the folder was downloaded to.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <p>Download my_folder to a local folder named my_folder.
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect_aws.s3</span> <span class="kn">import</span> <span class="n">S3Bucket</span>

<span class="n">s3_bucket</span> <span class="o">=</span> <span class="n">S3Bucket</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;my-bucket&quot;</span><span class="p">)</span>
<span class="n">s3_bucket</span><span class="o">.</span><span class="n">download_folder_to_path</span><span class="p">(</span><span class="s2">&quot;my_folder&quot;</span><span class="p">,</span> <span class="s2">&quot;my_folder&quot;</span><span class="p">)</span>
</code></pre></div></p>

        <details class="quote">
          <summary>Source code in <code>prefect_aws/s3.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@sync_compatible</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">download_folder_to_path</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">from_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">to_folder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">download_kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Downloads objects *within* a folder (excluding the folder itself)</span>
<span class="sd">    from the S3 bucket to a folder.</span>

<span class="sd">    Args:</span>
<span class="sd">        from_folder: The path to the folder to download from.</span>
<span class="sd">        to_folder: The path to download the folder to.</span>
<span class="sd">        **download_kwargs: Additional keyword arguments to pass to</span>
<span class="sd">            `Client.download_file`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The absolute path that the folder was downloaded to.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Download my_folder to a local folder named my_folder.</span>
<span class="sd">        ```python</span>
<span class="sd">        from prefect_aws.s3 import S3Bucket</span>

<span class="sd">        s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>
<span class="sd">        s3_bucket.download_folder_to_path(&quot;my_folder&quot;, &quot;my_folder&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">to_folder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">to_folder</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">to_folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">to_folder</span><span class="p">)</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>

    <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">get_s3_client</span><span class="p">()</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_objects</span><span class="p">(</span><span class="n">folder</span><span class="o">=</span><span class="n">from_folder</span><span class="p">)</span>

    <span class="c1"># do not call self._join_bucket_folder for filter</span>
    <span class="c1"># because it&#39;s built-in to that method already!</span>
    <span class="c1"># however, we still need to do it because we&#39;re using relative_to</span>
    <span class="n">bucket_folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_join_bucket_folder</span><span class="p">(</span><span class="n">from_folder</span><span class="p">)</span>

    <span class="n">async_coros</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="nb">object</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
        <span class="n">bucket_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="nb">object</span><span class="p">[</span><span class="s2">&quot;Key&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="n">bucket_folder</span><span class="p">)</span>
        <span class="c1"># this skips the actual directory itself, e.g.</span>
        <span class="c1"># `my_folder/` will be skipped</span>
        <span class="c1"># `my_folder/notes.txt` will be downloaded</span>
        <span class="k">if</span> <span class="n">bucket_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="k">continue</span>
        <span class="n">to_path</span> <span class="o">=</span> <span class="n">to_folder</span> <span class="o">/</span> <span class="n">bucket_path</span>
        <span class="n">to_path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">to_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">to_path</span><span class="p">)</span>  <span class="c1"># must be string</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Downloading object from bucket </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="si">!r}</span><span class="s2"> path &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bucket_path</span><span class="o">.</span><span class="n">as_posix</span><span class="p">()</span><span class="si">!r}</span><span class="s2"> to </span><span class="si">{</span><span class="n">to_path</span><span class="si">!r}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
        <span class="n">async_coros</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">run_sync_in_worker_thread</span><span class="p">(</span>
                <span class="n">client</span><span class="o">.</span><span class="n">download_file</span><span class="p">,</span>
                <span class="n">Bucket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="p">,</span>
                <span class="n">Key</span><span class="o">=</span><span class="nb">object</span><span class="p">[</span><span class="s2">&quot;Key&quot;</span><span class="p">],</span>
                <span class="n">Filename</span><span class="o">=</span><span class="n">to_path</span><span class="p">,</span>
                <span class="o">**</span><span class="n">download_kwargs</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">async_coros</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">to_folder</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="prefect_aws.s3.S3Bucket.download_object_to_file_object" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download_object_to_file_object</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Downloads an object from the object storage service to a file-like object,
which can be a BytesIO object or a BufferedWriter.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>from_path</code></td>
        <td><code>str</code></td>
        <td><p>The path to the object to download from; this gets prefixed
with the bucket_folder.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>to_file_object</code></td>
        <td><code>BinaryIO</code></td>
        <td><p>The file-like object to download the object to.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>**download_kwargs</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>Additional keyword arguments to pass to
<code>Client.download_fileobj</code>.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>BinaryIO</code></td>
      <td><p>The file-like object that the object was downloaded to.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <p>Download my_folder/notes.txt object to a BytesIO object.
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>

<span class="kn">from</span> <span class="nn">prefect_aws.s3</span> <span class="kn">import</span> <span class="n">S3Bucket</span>

<span class="n">s3_bucket</span> <span class="o">=</span> <span class="n">S3Bucket</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;my-bucket&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="n">BytesIO</span><span class="p">()</span> <span class="k">as</span> <span class="n">buf</span><span class="p">:</span>
    <span class="n">s3_bucket</span><span class="o">.</span><span class="n">download_object_to_file_object</span><span class="p">(</span><span class="s2">&quot;my_folder/notes.txt&quot;</span><span class="p">,</span> <span class="n">buf</span><span class="p">)</span>
</code></pre></div></p>
<p>Download my_folder/notes.txt object to a BufferedWriter.
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect_aws.s3</span> <span class="kn">import</span> <span class="n">S3Bucket</span>

<span class="n">s3_bucket</span> <span class="o">=</span> <span class="n">S3Bucket</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;my-bucket&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;notes.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">s3_bucket</span><span class="o">.</span><span class="n">download_object_to_file_object</span><span class="p">(</span><span class="s2">&quot;my_folder/notes.txt&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</code></pre></div></p>

        <details class="quote">
          <summary>Source code in <code>prefect_aws/s3.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@sync_compatible</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">download_object_to_file_object</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">from_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">to_file_object</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">,</span>
    <span class="o">**</span><span class="n">download_kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BinaryIO</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Downloads an object from the object storage service to a file-like object,</span>
<span class="sd">    which can be a BytesIO object or a BufferedWriter.</span>

<span class="sd">    Args:</span>
<span class="sd">        from_path: The path to the object to download from; this gets prefixed</span>
<span class="sd">            with the bucket_folder.</span>
<span class="sd">        to_file_object: The file-like object to download the object to.</span>
<span class="sd">        **download_kwargs: Additional keyword arguments to pass to</span>
<span class="sd">            `Client.download_fileobj`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The file-like object that the object was downloaded to.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Download my_folder/notes.txt object to a BytesIO object.</span>
<span class="sd">        ```python</span>
<span class="sd">        from io import BytesIO</span>

<span class="sd">        from prefect_aws.s3 import S3Bucket</span>

<span class="sd">        s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>
<span class="sd">        with BytesIO() as buf:</span>
<span class="sd">            s3_bucket.download_object_to_file_object(&quot;my_folder/notes.txt&quot;, buf)</span>
<span class="sd">        ```</span>

<span class="sd">        Download my_folder/notes.txt object to a BufferedWriter.</span>
<span class="sd">        ```python</span>
<span class="sd">        from prefect_aws.s3 import S3Bucket</span>

<span class="sd">        s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>
<span class="sd">        with open(&quot;notes.txt&quot;, &quot;wb&quot;) as f:</span>
<span class="sd">            s3_bucket.download_object_to_file_object(&quot;my_folder/notes.txt&quot;, f)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">get_s3_client</span><span class="p">()</span>
    <span class="n">bucket_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_join_bucket_folder</span><span class="p">(</span><span class="n">from_path</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Preparing to download object from bucket </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="si">!r}</span><span class="s2"> &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;path </span><span class="si">{</span><span class="n">bucket_path</span><span class="si">!r}</span><span class="s2"> to file object.&quot;</span>
    <span class="p">)</span>
    <span class="k">await</span> <span class="n">run_sync_in_worker_thread</span><span class="p">(</span>
        <span class="n">client</span><span class="o">.</span><span class="n">download_fileobj</span><span class="p">,</span>
        <span class="n">Bucket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="p">,</span>
        <span class="n">Key</span><span class="o">=</span><span class="n">bucket_path</span><span class="p">,</span>
        <span class="n">Fileobj</span><span class="o">=</span><span class="n">to_file_object</span><span class="p">,</span>
        <span class="o">**</span><span class="n">download_kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Downloaded object from bucket </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="si">!r}</span><span class="s2"> path </span><span class="si">{</span><span class="n">bucket_path</span><span class="si">!r}</span><span class="s2"> &quot;</span>
        <span class="s2">&quot;to file object.&quot;</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">to_file_object</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="prefect_aws.s3.S3Bucket.download_object_to_path" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download_object_to_path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Downloads an object from the S3 bucket to a path.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>from_path</code></td>
        <td><code>str</code></td>
        <td><p>The path to the object to download; this gets prefixed
with the bucket_folder.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>to_path</code></td>
        <td><code>Union[str, pathlib.Path]</code></td>
        <td><p>The path to download the object to. If not provided, the
object's name will be used.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>**download_kwargs</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>Additional keyword arguments to pass to
<code>Client.download_file</code>.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Path</code></td>
      <td><p>The absolute path that the object was downloaded to.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <p>Download my_folder/notes.txt object to notes.txt.
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect_aws.s3</span> <span class="kn">import</span> <span class="n">S3Bucket</span>

<span class="n">s3_bucket</span> <span class="o">=</span> <span class="n">S3Bucket</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;my-bucket&quot;</span><span class="p">)</span>
<span class="n">s3_bucket</span><span class="o">.</span><span class="n">download_object_to_path</span><span class="p">(</span><span class="s2">&quot;my_folder/notes.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;notes.txt&quot;</span><span class="p">)</span>
</code></pre></div></p>

        <details class="quote">
          <summary>Source code in <code>prefect_aws/s3.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@sync_compatible</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">download_object_to_path</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">from_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">to_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]],</span>
    <span class="o">**</span><span class="n">download_kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Downloads an object from the S3 bucket to a path.</span>

<span class="sd">    Args:</span>
<span class="sd">        from_path: The path to the object to download; this gets prefixed</span>
<span class="sd">            with the bucket_folder.</span>
<span class="sd">        to_path: The path to download the object to. If not provided, the</span>
<span class="sd">            object&#39;s name will be used.</span>
<span class="sd">        **download_kwargs: Additional keyword arguments to pass to</span>
<span class="sd">            `Client.download_file`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The absolute path that the object was downloaded to.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Download my_folder/notes.txt object to notes.txt.</span>
<span class="sd">        ```python</span>
<span class="sd">        from prefect_aws.s3 import S3Bucket</span>

<span class="sd">        s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>
<span class="sd">        s3_bucket.download_object_to_path(&quot;my_folder/notes.txt&quot;, &quot;notes.txt&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">to_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">to_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">from_path</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>

    <span class="c1"># making path absolute, but converting back to str here</span>
    <span class="c1"># since !r looks nicer that way and filename arg expects str</span>
    <span class="n">to_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">to_path</span><span class="p">)</span><span class="o">.</span><span class="n">absolute</span><span class="p">())</span>
    <span class="n">bucket_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_join_bucket_folder</span><span class="p">(</span><span class="n">from_path</span><span class="p">)</span>
    <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">get_s3_client</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Preparing to download object from bucket </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="si">!r}</span><span class="s2"> &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;path </span><span class="si">{</span><span class="n">bucket_path</span><span class="si">!r}</span><span class="s2"> to </span><span class="si">{</span><span class="n">to_path</span><span class="si">!r}</span><span class="s2">.&quot;</span>
    <span class="p">)</span>
    <span class="k">await</span> <span class="n">run_sync_in_worker_thread</span><span class="p">(</span>
        <span class="n">client</span><span class="o">.</span><span class="n">download_file</span><span class="p">,</span>
        <span class="n">Bucket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="p">,</span>
        <span class="n">Key</span><span class="o">=</span><span class="n">from_path</span><span class="p">,</span>
        <span class="n">Filename</span><span class="o">=</span><span class="n">to_path</span><span class="p">,</span>
        <span class="o">**</span><span class="n">download_kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Downloaded object from bucket </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="si">!r}</span><span class="s2"> path </span><span class="si">{</span><span class="n">bucket_path</span><span class="si">!r}</span><span class="s2"> &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;to </span><span class="si">{</span><span class="n">to_path</span><span class="si">!r}</span><span class="s2">.&quot;</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">to_path</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="prefect_aws.s3.S3Bucket.get_directory" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_directory</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Copies a folder from the configured S3 bucket to a local directory.</p>
<p>Defaults to copying the entire contents of the block's basepath to the current
working directory.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>from_path</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Path in S3 bucket to download from. Defaults to the block's
configured basepath.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>local_path</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Local path to download S3 contents to. Defaults to the current
working directory.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>prefect_aws/s3.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@sync_compatible</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">get_directory</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">from_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">local_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Copies a folder from the configured S3 bucket to a local directory.</span>

<span class="sd">    Defaults to copying the entire contents of the block&#39;s basepath to the current</span>
<span class="sd">    working directory.</span>

<span class="sd">    Args:</span>
<span class="sd">        from_path: Path in S3 bucket to download from. Defaults to the block&#39;s</span>
<span class="sd">            configured basepath.</span>
<span class="sd">        local_path: Local path to download S3 contents to. Defaults to the current</span>
<span class="sd">            working directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bucket_folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bucket_folder</span>
    <span class="k">if</span> <span class="n">from_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">from_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">bucket_folder</span><span class="p">)</span> <span class="k">if</span> <span class="n">bucket_folder</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>

    <span class="k">if</span> <span class="n">local_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">local_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">absolute</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">local_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">local_path</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">())</span>

    <span class="n">bucket</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_bucket_resource</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">bucket</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Prefix</span><span class="o">=</span><span class="n">from_path</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;/&quot;</span><span class="p">:</span>
            <span class="c1"># object is a folder and will be created if it contains any objects</span>
            <span class="k">continue</span>
        <span class="n">target</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">local_path</span><span class="p">,</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">from_path</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">target</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">bucket</span><span class="o">.</span><span class="n">download_file</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="prefect_aws.s3.S3Bucket.list_objects" class="doc doc-heading">
<code class="highlight language-python"><span class="n">list_objects</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">


<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>folder</code></td>
        <td><code>str</code></td>
        <td><p>Folder to list objects from.</p></td>
        <td><code>&#39;&#39;</code></td>
      </tr>
      <tr>
        <td><code>delimiter</code></td>
        <td><code>str</code></td>
        <td><p>Character used to group keys of listed objects.</p></td>
        <td><code>&#39;&#39;</code></td>
      </tr>
      <tr>
        <td><code>page_size</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Number of objects to return in each request to the AWS API.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>max_items</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Maximum number of objects that to be returned by task.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>jmespath_query</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Query used to filter objects based on object attributes refer to
the <a href="https://boto3.amazonaws.com/v1/documentation/api/latest/guide/paginators.html#filtering-results-with-jmespath">boto3 docs</a>
for more information on how to construct queries.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[Dict[str, Any]]</code></td>
      <td><p>List of objects and their metadata in the bucket.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <p>List objects under the <code>base_folder</code>.
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect_aws.s3</span> <span class="kn">import</span> <span class="n">S3Bucket</span>

<span class="n">s3_bucket</span> <span class="o">=</span> <span class="n">S3Bucket</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;my-bucket&quot;</span><span class="p">)</span>
<span class="n">s3_bucket</span><span class="o">.</span><span class="n">list_objects</span><span class="p">(</span><span class="s2">&quot;base_folder&quot;</span><span class="p">)</span>
</code></pre></div></p>

        <details class="quote">
          <summary>Source code in <code>prefect_aws/s3.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@sync_compatible</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">list_objects</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">folder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">delimiter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">page_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_items</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">jmespath_query</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        folder: Folder to list objects from.</span>
<span class="sd">        delimiter: Character used to group keys of listed objects.</span>
<span class="sd">        page_size: Number of objects to return in each request to the AWS API.</span>
<span class="sd">        max_items: Maximum number of objects that to be returned by task.</span>
<span class="sd">        jmespath_query: Query used to filter objects based on object attributes refer to</span>
<span class="sd">            the [boto3 docs](https://boto3.amazonaws.com/v1/documentation/api/latest/guide/paginators.html#filtering-results-with-jmespath)</span>
<span class="sd">            for more information on how to construct queries.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of objects and their metadata in the bucket.</span>

<span class="sd">    Examples:</span>
<span class="sd">        List objects under the `base_folder`.</span>
<span class="sd">        ```python</span>
<span class="sd">        from prefect_aws.s3 import S3Bucket</span>

<span class="sd">        s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>
<span class="sd">        s3_bucket.list_objects(&quot;base_folder&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>
    <span class="n">bucket_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_join_bucket_folder</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>
    <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">get_s3_client</span><span class="p">()</span>
    <span class="n">paginator</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_paginator</span><span class="p">(</span><span class="s2">&quot;list_objects_v2&quot;</span><span class="p">)</span>
    <span class="n">page_iterator</span> <span class="o">=</span> <span class="n">paginator</span><span class="o">.</span><span class="n">paginate</span><span class="p">(</span>
        <span class="n">Bucket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="p">,</span>
        <span class="n">Prefix</span><span class="o">=</span><span class="n">bucket_path</span><span class="p">,</span>
        <span class="n">Delimiter</span><span class="o">=</span><span class="n">delimiter</span><span class="p">,</span>
        <span class="n">PaginationConfig</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;PageSize&quot;</span><span class="p">:</span> <span class="n">page_size</span><span class="p">,</span> <span class="s2">&quot;MaxItems&quot;</span><span class="p">:</span> <span class="n">max_items</span><span class="p">},</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">jmespath_query</span><span class="p">:</span>
        <span class="n">page_iterator</span> <span class="o">=</span> <span class="n">page_iterator</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">jmespath_query</span><span class="si">}</span><span class="s2"> | </span><span class="se">{{</span><span class="s2">Contents: @</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Listing objects in bucket </span><span class="si">{</span><span class="n">bucket_path</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="k">await</span> <span class="n">run_sync_in_worker_thread</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_list_objects_sync</span><span class="p">,</span> <span class="n">page_iterator</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">objects</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="prefect_aws.s3.S3Bucket.move_object" class="doc doc-heading">
<code class="highlight language-python"><span class="n">move_object</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Uses S3's internal CopyObject and DeleteObject to move objects within or
between buckets. To move objects between buckets, <code>self</code>'s credentials must
have permission to read and delete the source object and write to the target
object. If the credentials do not have those permissions, this method will
raise an error. If the credentials have permission to read the source object
but not delete it, the object will be copied but not deleted.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>from_path</code></td>
        <td><code>Union[str, pathlib.Path]</code></td>
        <td><p>The path of the object to move.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>to_path</code></td>
        <td><code>Union[str, pathlib.Path]</code></td>
        <td><p>The path to move the object to.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>to_bucket</code></td>
        <td><code>Union[S3Bucket, str]</code></td>
        <td><p>The bucket to move to. Defaults to the current bucket.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The path that the object was moved to. Excludes the bucket name.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <p>Move notes.txt from my_folder/notes.txt to my_folder/notes_copy.txt.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect_aws.s3</span> <span class="kn">import</span> <span class="n">S3Bucket</span>

<span class="n">s3_bucket</span> <span class="o">=</span> <span class="n">S3Bucket</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;my-bucket&quot;</span><span class="p">)</span>
<span class="n">s3_bucket</span><span class="o">.</span><span class="n">move_object</span><span class="p">(</span><span class="s2">&quot;my_folder/notes.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;my_folder/notes_copy.txt&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Move notes.txt from my_folder/notes.txt to my_folder/notes_copy.txt in
another bucket.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect_aws.s3</span> <span class="kn">import</span> <span class="n">S3Bucket</span>

<span class="n">s3_bucket</span> <span class="o">=</span> <span class="n">S3Bucket</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;my-bucket&quot;</span><span class="p">)</span>
<span class="n">s3_bucket</span><span class="o">.</span><span class="n">move_object</span><span class="p">(</span>
    <span class="s2">&quot;my_folder/notes.txt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;my_folder/notes_copy.txt&quot;</span><span class="p">,</span>
    <span class="n">to_bucket</span><span class="o">=</span><span class="s2">&quot;other-bucket&quot;</span>
<span class="p">)</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>prefect_aws/s3.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@sync_compatible</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">move_object</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">from_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
    <span class="n">to_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
    <span class="n">to_bucket</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;S3Bucket&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Uses S3&#39;s internal CopyObject and DeleteObject to move objects within or</span>
<span class="sd">    between buckets. To move objects between buckets, `self`&#39;s credentials must</span>
<span class="sd">    have permission to read and delete the source object and write to the target</span>
<span class="sd">    object. If the credentials do not have those permissions, this method will</span>
<span class="sd">    raise an error. If the credentials have permission to read the source object</span>
<span class="sd">    but not delete it, the object will be copied but not deleted.</span>

<span class="sd">    Args:</span>
<span class="sd">        from_path: The path of the object to move.</span>
<span class="sd">        to_path: The path to move the object to.</span>
<span class="sd">        to_bucket: The bucket to move to. Defaults to the current bucket.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The path that the object was moved to. Excludes the bucket name.</span>

<span class="sd">    Examples:</span>

<span class="sd">        Move notes.txt from my_folder/notes.txt to my_folder/notes_copy.txt.</span>

<span class="sd">        ```python</span>
<span class="sd">        from prefect_aws.s3 import S3Bucket</span>

<span class="sd">        s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>
<span class="sd">        s3_bucket.move_object(&quot;my_folder/notes.txt&quot;, &quot;my_folder/notes_copy.txt&quot;)</span>
<span class="sd">        ```</span>

<span class="sd">        Move notes.txt from my_folder/notes.txt to my_folder/notes_copy.txt in</span>
<span class="sd">        another bucket.</span>

<span class="sd">        ```python</span>
<span class="sd">        from prefect_aws.s3 import S3Bucket</span>

<span class="sd">        s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>
<span class="sd">        s3_bucket.move_object(</span>
<span class="sd">            &quot;my_folder/notes.txt&quot;,</span>
<span class="sd">            &quot;my_folder/notes_copy.txt&quot;,</span>
<span class="sd">            to_bucket=&quot;other-bucket&quot;</span>
<span class="sd">        )</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s3_client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">get_s3_client</span><span class="p">()</span>

    <span class="n">source_bucket_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span>
    <span class="n">source_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_path</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">from_path</span><span class="p">)</span><span class="o">.</span><span class="n">as_posix</span><span class="p">())</span>

    <span class="c1"># Default to moving within the same bucket</span>
    <span class="n">to_bucket</span> <span class="o">=</span> <span class="n">to_bucket</span> <span class="ow">or</span> <span class="bp">self</span>

    <span class="n">target_bucket_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">target_path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to_bucket</span><span class="p">,</span> <span class="n">S3Bucket</span><span class="p">):</span>
        <span class="n">target_bucket_name</span> <span class="o">=</span> <span class="n">to_bucket</span><span class="o">.</span><span class="n">bucket_name</span>
        <span class="n">target_path</span> <span class="o">=</span> <span class="n">to_bucket</span><span class="o">.</span><span class="n">_resolve_path</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">to_path</span><span class="p">)</span><span class="o">.</span><span class="n">as_posix</span><span class="p">())</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to_bucket</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">target_bucket_name</span> <span class="o">=</span> <span class="n">to_bucket</span>
        <span class="n">target_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">to_path</span><span class="p">)</span><span class="o">.</span><span class="n">as_posix</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;to_bucket must be a string or S3Bucket, not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">to_bucket</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="s2">&quot;Moving object from s3://</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2"> to s3://</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">source_bucket_name</span><span class="p">,</span>
        <span class="n">source_path</span><span class="p">,</span>
        <span class="n">target_bucket_name</span><span class="p">,</span>
        <span class="n">target_path</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># If invalid, should error and prevent next operation</span>
    <span class="n">s3_client</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span>
        <span class="n">CopySource</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Bucket&quot;</span><span class="p">:</span> <span class="n">source_bucket_name</span><span class="p">,</span> <span class="s2">&quot;Key&quot;</span><span class="p">:</span> <span class="n">source_path</span><span class="p">},</span>
        <span class="n">Bucket</span><span class="o">=</span><span class="n">target_bucket_name</span><span class="p">,</span>
        <span class="n">Key</span><span class="o">=</span><span class="n">target_path</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">s3_client</span><span class="o">.</span><span class="n">delete_object</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="n">source_bucket_name</span><span class="p">,</span> <span class="n">Key</span><span class="o">=</span><span class="n">source_path</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">target_path</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="prefect_aws.s3.S3Bucket.put_directory" class="doc doc-heading">
<code class="highlight language-python"><span class="n">put_directory</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Uploads a directory from a given local path to the configured S3 bucket in a
given folder.</p>
<p>Defaults to uploading the entire contents the current working directory to the
block's basepath.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>local_path</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Path to local directory to upload from.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>to_path</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Path in S3 bucket to upload to. Defaults to block's configured
basepath.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ignore_file</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Path to file containing gitignore style expressions for
filepaths to ignore.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>prefect_aws/s3.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@sync_compatible</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">put_directory</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">local_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">to_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ignore_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Uploads a directory from a given local path to the configured S3 bucket in a</span>
<span class="sd">    given folder.</span>

<span class="sd">    Defaults to uploading the entire contents the current working directory to the</span>
<span class="sd">    block&#39;s basepath.</span>

<span class="sd">    Args:</span>
<span class="sd">        local_path: Path to local directory to upload from.</span>
<span class="sd">        to_path: Path in S3 bucket to upload to. Defaults to block&#39;s configured</span>
<span class="sd">            basepath.</span>
<span class="sd">        ignore_file: Path to file containing gitignore style expressions for</span>
<span class="sd">            filepaths to ignore.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">to_path</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="n">to_path</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">to_path</span>

    <span class="k">if</span> <span class="n">local_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">local_path</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span>

    <span class="n">included_files</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">ignore_file</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ignore_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">ignore_patterns</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

        <span class="n">included_files</span> <span class="o">=</span> <span class="n">filter_files</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="n">ignore_patterns</span><span class="p">)</span>

    <span class="n">uploaded_file_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">local_file_path</span> <span class="ow">in</span> <span class="n">Path</span><span class="p">(</span><span class="n">local_path</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">included_files</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">local_file_path</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="n">local_path</span><span class="p">))</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">included_files</span>
        <span class="p">):</span>
            <span class="k">continue</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">local_file_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="n">remote_file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">to_path</span><span class="p">)</span> <span class="o">/</span> <span class="n">local_file_path</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span>
                <span class="n">local_path</span>
            <span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">local_file_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">local_file</span><span class="p">:</span>
                <span class="n">local_file_content</span> <span class="o">=</span> <span class="n">local_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_path</span><span class="p">(</span>
                <span class="n">remote_file_path</span><span class="o">.</span><span class="n">as_posix</span><span class="p">(),</span> <span class="n">content</span><span class="o">=</span><span class="n">local_file_content</span>
            <span class="p">)</span>
            <span class="n">uploaded_file_count</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">uploaded_file_count</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="prefect_aws.s3.S3Bucket.read_path" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read_path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Read specified path from S3 and return contents. Provide the entire
path to the key in S3.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>path</code></td>
        <td><code>str</code></td>
        <td><p>Entire path to (and including) the key.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <p>Read "subfolder/file1" contents from an S3 bucket named "bucket":
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect_aws</span> <span class="kn">import</span> <span class="n">AwsCredentials</span>
<span class="kn">from</span> <span class="nn">prefect_aws.s3</span> <span class="kn">import</span> <span class="n">S3Bucket</span>

<span class="n">aws_creds</span> <span class="o">=</span> <span class="n">AwsCredentials</span><span class="p">(</span>
    <span class="n">aws_access_key_id</span><span class="o">=</span><span class="n">AWS_ACCESS_KEY_ID</span><span class="p">,</span>
    <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">AWS_SECRET_ACCESS_KEY</span>
<span class="p">)</span>

<span class="n">s3_bucket_block</span> <span class="o">=</span> <span class="n">S3Bucket</span><span class="p">(</span>
    <span class="n">bucket_name</span><span class="o">=</span><span class="s2">&quot;bucket&quot;</span><span class="p">,</span>
    <span class="n">credentials</span><span class="o">=</span><span class="n">aws_creds</span><span class="p">,</span>
    <span class="n">bucket_folder</span><span class="o">=</span><span class="s2">&quot;subfolder&quot;</span>
<span class="p">)</span>

<span class="n">key_contents</span> <span class="o">=</span> <span class="n">s3_bucket_block</span><span class="o">.</span><span class="n">read_path</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;subfolder/file1&quot;</span><span class="p">)</span>
</code></pre></div></p>

        <details class="quote">
          <summary>Source code in <code>prefect_aws/s3.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@sync_compatible</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">read_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Read specified path from S3 and return contents. Provide the entire</span>
<span class="sd">    path to the key in S3.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: Entire path to (and including) the key.</span>

<span class="sd">    Example:</span>
<span class="sd">        Read &quot;subfolder/file1&quot; contents from an S3 bucket named &quot;bucket&quot;:</span>
<span class="sd">        ```python</span>
<span class="sd">        from prefect_aws import AwsCredentials</span>
<span class="sd">        from prefect_aws.s3 import S3Bucket</span>

<span class="sd">        aws_creds = AwsCredentials(</span>
<span class="sd">            aws_access_key_id=AWS_ACCESS_KEY_ID,</span>
<span class="sd">            aws_secret_access_key=AWS_SECRET_ACCESS_KEY</span>
<span class="sd">        )</span>

<span class="sd">        s3_bucket_block = S3Bucket(</span>
<span class="sd">            bucket_name=&quot;bucket&quot;,</span>
<span class="sd">            credentials=aws_creds,</span>
<span class="sd">            bucket_folder=&quot;subfolder&quot;</span>
<span class="sd">        )</span>

<span class="sd">        key_contents = s3_bucket_block.read_path(path=&quot;subfolder/file1&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="k">return</span> <span class="k">await</span> <span class="n">run_sync_in_worker_thread</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_sync</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="prefect_aws.s3.S3Bucket.stream_from" class="doc doc-heading">
<code class="highlight language-python"><span class="n">stream_from</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Streams an object from another bucket to this bucket. Requires the
object to be downloaded and uploaded in chunks. If <code>self</code>'s credentials
allow for writes to the other bucket, try using <code>S3Bucket.copy_object</code>.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bucket</code></td>
        <td><code>S3Bucket</code></td>
        <td><p>The bucket to stream from.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>from_path</code></td>
        <td><code>str</code></td>
        <td><p>The path of the object to stream.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>to_path</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>The path to stream the object to. Defaults to the object's name.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>**upload_kwargs</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>Additional keyword arguments to pass to
<code>Client.upload_fileobj</code>.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The path that the object was uploaded to.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <p>Stream notes.txt from your-bucket/notes.txt to my-bucket/landed/notes.txt.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect_aws.s3</span> <span class="kn">import</span> <span class="n">S3Bucket</span>

<span class="n">your_s3_bucket</span> <span class="o">=</span> <span class="n">S3Bucket</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;your-bucket&quot;</span><span class="p">)</span>
<span class="n">my_s3_bucket</span> <span class="o">=</span> <span class="n">S3Bucket</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;my-bucket&quot;</span><span class="p">)</span>

<span class="n">my_s3_bucket</span><span class="o">.</span><span class="n">stream_from</span><span class="p">(</span>
    <span class="n">your_s3_bucket</span><span class="p">,</span>
    <span class="s2">&quot;notes.txt&quot;</span><span class="p">,</span>
    <span class="n">to_path</span><span class="o">=</span><span class="s2">&quot;landed/notes.txt&quot;</span>
<span class="p">)</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>prefect_aws/s3.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@sync_compatible</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">stream_from</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">bucket</span><span class="p">:</span> <span class="s2">&quot;S3Bucket&quot;</span><span class="p">,</span>
    <span class="n">from_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">to_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">upload_kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Streams an object from another bucket to this bucket. Requires the</span>
<span class="sd">    object to be downloaded and uploaded in chunks. If `self`&#39;s credentials</span>
<span class="sd">    allow for writes to the other bucket, try using `S3Bucket.copy_object`.</span>

<span class="sd">    Args:</span>
<span class="sd">        bucket: The bucket to stream from.</span>
<span class="sd">        from_path: The path of the object to stream.</span>
<span class="sd">        to_path: The path to stream the object to. Defaults to the object&#39;s name.</span>
<span class="sd">        **upload_kwargs: Additional keyword arguments to pass to</span>
<span class="sd">            `Client.upload_fileobj`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The path that the object was uploaded to.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Stream notes.txt from your-bucket/notes.txt to my-bucket/landed/notes.txt.</span>

<span class="sd">        ```python</span>
<span class="sd">        from prefect_aws.s3 import S3Bucket</span>

<span class="sd">        your_s3_bucket = S3Bucket.load(&quot;your-bucket&quot;)</span>
<span class="sd">        my_s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>

<span class="sd">        my_s3_bucket.stream_from(</span>
<span class="sd">            your_s3_bucket,</span>
<span class="sd">            &quot;notes.txt&quot;,</span>
<span class="sd">            to_path=&quot;landed/notes.txt&quot;</span>
<span class="sd">        )</span>
<span class="sd">        ```</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">to_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">to_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">from_path</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>

    <span class="c1"># Get the source object&#39;s StreamingBody</span>
    <span class="n">from_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">bucket</span><span class="o">.</span><span class="n">_join_bucket_folder</span><span class="p">(</span><span class="n">from_path</span><span class="p">)</span>
    <span class="n">from_client</span> <span class="o">=</span> <span class="n">bucket</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">get_s3_client</span><span class="p">()</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="k">await</span> <span class="n">run_sync_in_worker_thread</span><span class="p">(</span>
        <span class="n">from_client</span><span class="o">.</span><span class="n">get_object</span><span class="p">,</span> <span class="n">Bucket</span><span class="o">=</span><span class="n">bucket</span><span class="o">.</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">Key</span><span class="o">=</span><span class="n">from_path</span>
    <span class="p">)</span>
    <span class="n">body</span><span class="p">:</span> <span class="n">StreamingBody</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;Body&quot;</span><span class="p">]</span>

    <span class="c1"># Upload the StreamingBody to this bucket</span>
    <span class="n">bucket_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_join_bucket_folder</span><span class="p">(</span><span class="n">to_path</span><span class="p">))</span>
    <span class="n">to_client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">get_s3_client</span><span class="p">()</span>
    <span class="k">await</span> <span class="n">run_sync_in_worker_thread</span><span class="p">(</span>
        <span class="n">to_client</span><span class="o">.</span><span class="n">upload_fileobj</span><span class="p">,</span>
        <span class="n">Fileobj</span><span class="o">=</span><span class="n">body</span><span class="p">,</span>
        <span class="n">Bucket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="p">,</span>
        <span class="n">Key</span><span class="o">=</span><span class="n">bucket_path</span><span class="p">,</span>
        <span class="o">**</span><span class="n">upload_kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Streamed s3://</span><span class="si">{</span><span class="n">bucket</span><span class="o">.</span><span class="n">bucket_name</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">from_path</span><span class="si">}</span><span class="s2"> to the bucket &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="si">!r}</span><span class="s2"> path </span><span class="si">{</span><span class="n">bucket_path</span><span class="si">!r}</span><span class="s2">.&quot;</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">bucket_path</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="prefect_aws.s3.S3Bucket.upload_from_file_object" class="doc doc-heading">
<code class="highlight language-python"><span class="n">upload_from_file_object</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Uploads an object to the S3 bucket from a file-like object,
which can be a BytesIO object or a BufferedReader.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>from_file_object</code></td>
        <td><code>BinaryIO</code></td>
        <td><p>The file-like object to upload from.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>to_path</code></td>
        <td><code>str</code></td>
        <td><p>The path to upload the object to.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>**upload_kwargs</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>Additional keyword arguments to pass to
<code>Client.upload_fileobj</code>.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The path that the object was uploaded to.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <p>Upload BytesIO object to my_folder/notes.txt.
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>

<span class="kn">from</span> <span class="nn">prefect_aws.s3</span> <span class="kn">import</span> <span class="n">S3Bucket</span>

<span class="n">s3_bucket</span> <span class="o">=</span> <span class="n">S3Bucket</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;my-bucket&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;notes.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">s3_bucket</span><span class="o">.</span><span class="n">upload_from_file_object</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;my_folder/notes.txt&quot;</span><span class="p">)</span>
</code></pre></div></p>
<p>Upload BufferedReader object to my_folder/notes.txt.
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect_aws.s3</span> <span class="kn">import</span> <span class="n">S3Bucket</span>

<span class="n">s3_bucket</span> <span class="o">=</span> <span class="n">S3Bucket</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;my-bucket&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;notes.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">s3_bucket</span><span class="o">.</span><span class="n">upload_from_file_object</span><span class="p">(</span>
        <span class="n">f</span><span class="p">,</span> <span class="s2">&quot;my_folder/notes.txt&quot;</span>
    <span class="p">)</span>
</code></pre></div></p>

        <details class="quote">
          <summary>Source code in <code>prefect_aws/s3.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@sync_compatible</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">upload_from_file_object</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">from_file_object</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">,</span> <span class="n">to_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">upload_kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Uploads an object to the S3 bucket from a file-like object,</span>
<span class="sd">    which can be a BytesIO object or a BufferedReader.</span>

<span class="sd">    Args:</span>
<span class="sd">        from_file_object: The file-like object to upload from.</span>
<span class="sd">        to_path: The path to upload the object to.</span>
<span class="sd">        **upload_kwargs: Additional keyword arguments to pass to</span>
<span class="sd">            `Client.upload_fileobj`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The path that the object was uploaded to.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Upload BytesIO object to my_folder/notes.txt.</span>
<span class="sd">        ```python</span>
<span class="sd">        from io import BytesIO</span>

<span class="sd">        from prefect_aws.s3 import S3Bucket</span>

<span class="sd">        s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>
<span class="sd">        with open(&quot;notes.txt&quot;, &quot;rb&quot;) as f:</span>
<span class="sd">            s3_bucket.upload_from_file_object(f, &quot;my_folder/notes.txt&quot;)</span>
<span class="sd">        ```</span>

<span class="sd">        Upload BufferedReader object to my_folder/notes.txt.</span>
<span class="sd">        ```python</span>
<span class="sd">        from prefect_aws.s3 import S3Bucket</span>

<span class="sd">        s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>
<span class="sd">        with open(&quot;notes.txt&quot;, &quot;rb&quot;) as f:</span>
<span class="sd">            s3_bucket.upload_from_file_object(</span>
<span class="sd">                f, &quot;my_folder/notes.txt&quot;</span>
<span class="sd">            )</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bucket_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_join_bucket_folder</span><span class="p">(</span><span class="n">to_path</span><span class="p">))</span>
    <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">get_s3_client</span><span class="p">()</span>
    <span class="k">await</span> <span class="n">run_sync_in_worker_thread</span><span class="p">(</span>
        <span class="n">client</span><span class="o">.</span><span class="n">upload_fileobj</span><span class="p">,</span>
        <span class="n">Fileobj</span><span class="o">=</span><span class="n">from_file_object</span><span class="p">,</span>
        <span class="n">Bucket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="p">,</span>
        <span class="n">Key</span><span class="o">=</span><span class="n">bucket_path</span><span class="p">,</span>
        <span class="o">**</span><span class="n">upload_kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="s2">&quot;Uploaded from file object to the bucket &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="si">!r}</span><span class="s2"> path </span><span class="si">{</span><span class="n">bucket_path</span><span class="si">!r}</span><span class="s2">.&quot;</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">bucket_path</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="prefect_aws.s3.S3Bucket.upload_from_folder" class="doc doc-heading">
<code class="highlight language-python"><span class="n">upload_from_folder</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Uploads files <em>within</em> a folder (excluding the folder itself)
to the object storage service folder.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>from_folder</code></td>
        <td><code>Union[str, pathlib.Path]</code></td>
        <td><p>The path to the folder to upload from.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>to_folder</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>The path to upload the folder to.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>**upload_kwargs</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>Additional keyword arguments to pass to
<code>Client.upload_fileobj</code>.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The path that the folder was uploaded to.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <p>Upload contents from my_folder to new_folder.
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect_aws.s3</span> <span class="kn">import</span> <span class="n">S3Bucket</span>

<span class="n">s3_bucket</span> <span class="o">=</span> <span class="n">S3Bucket</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;my-bucket&quot;</span><span class="p">)</span>
<span class="n">s3_bucket</span><span class="o">.</span><span class="n">upload_from_folder</span><span class="p">(</span><span class="s2">&quot;my_folder&quot;</span><span class="p">,</span> <span class="s2">&quot;new_folder&quot;</span><span class="p">)</span>
</code></pre></div></p>

        <details class="quote">
          <summary>Source code in <code>prefect_aws/s3.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@sync_compatible</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">upload_from_folder</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">from_folder</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
    <span class="n">to_folder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">upload_kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Uploads files *within* a folder (excluding the folder itself)</span>
<span class="sd">    to the object storage service folder.</span>

<span class="sd">    Args:</span>
<span class="sd">        from_folder: The path to the folder to upload from.</span>
<span class="sd">        to_folder: The path to upload the folder to.</span>
<span class="sd">        **upload_kwargs: Additional keyword arguments to pass to</span>
<span class="sd">            `Client.upload_fileobj`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The path that the folder was uploaded to.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Upload contents from my_folder to new_folder.</span>
<span class="sd">        ```python</span>
<span class="sd">        from prefect_aws.s3 import S3Bucket</span>

<span class="sd">        s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>
<span class="sd">        s3_bucket.upload_from_folder(&quot;my_folder&quot;, &quot;new_folder&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">from_folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">from_folder</span><span class="p">)</span>
    <span class="n">bucket_folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_join_bucket_folder</span><span class="p">(</span><span class="n">to_folder</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="n">num_uploaded</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">get_s3_client</span><span class="p">()</span>

    <span class="n">async_coros</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">from_path</span> <span class="ow">in</span> <span class="n">from_folder</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;**/*&quot;</span><span class="p">):</span>
        <span class="c1"># this skips the actual directory itself, e.g.</span>
        <span class="c1"># `my_folder/` will be skipped</span>
        <span class="c1"># `my_folder/notes.txt` will be uploaded</span>
        <span class="k">if</span> <span class="n">from_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="k">continue</span>
        <span class="n">bucket_path</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">Path</span><span class="p">(</span><span class="n">bucket_folder</span><span class="p">)</span> <span class="o">/</span> <span class="n">from_path</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="n">from_folder</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">as_posix</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Uploading from </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">from_path</span><span class="p">)</span><span class="si">!r}</span><span class="s2"> to the bucket &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="si">!r}</span><span class="s2"> path </span><span class="si">{</span><span class="n">bucket_path</span><span class="si">!r}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
        <span class="n">async_coros</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">run_sync_in_worker_thread</span><span class="p">(</span>
                <span class="n">client</span><span class="o">.</span><span class="n">upload_file</span><span class="p">,</span>
                <span class="n">Filename</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">from_path</span><span class="p">),</span>
                <span class="n">Bucket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="p">,</span>
                <span class="n">Key</span><span class="o">=</span><span class="n">bucket_path</span><span class="p">,</span>
                <span class="o">**</span><span class="n">upload_kwargs</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">num_uploaded</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">async_coros</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">num_uploaded</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No files were uploaded from </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">from_folder</span><span class="p">)</span><span class="si">!r}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Uploaded </span><span class="si">{</span><span class="n">num_uploaded</span><span class="si">}</span><span class="s2"> files from </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">from_folder</span><span class="p">)</span><span class="si">!r}</span><span class="s2"> to &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;the bucket </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="si">!r}</span><span class="s2"> path </span><span class="si">{</span><span class="n">bucket_path</span><span class="si">!r}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">to_folder</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="prefect_aws.s3.S3Bucket.upload_from_path" class="doc doc-heading">
<code class="highlight language-python"><span class="n">upload_from_path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Uploads an object from a path to the S3 bucket.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>from_path</code></td>
        <td><code>Union[str, pathlib.Path]</code></td>
        <td><p>The path to the file to upload from.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>to_path</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>The path to upload the file to.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>**upload_kwargs</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>Additional keyword arguments to pass to <code>Client.upload</code>.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The path that the object was uploaded to.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <p>Upload notes.txt to my_folder/notes.txt.
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect_aws.s3</span> <span class="kn">import</span> <span class="n">S3Bucket</span>

<span class="n">s3_bucket</span> <span class="o">=</span> <span class="n">S3Bucket</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;my-bucket&quot;</span><span class="p">)</span>
<span class="n">s3_bucket</span><span class="o">.</span><span class="n">upload_from_path</span><span class="p">(</span><span class="s2">&quot;notes.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;my_folder/notes.txt&quot;</span><span class="p">)</span>
</code></pre></div></p>

        <details class="quote">
          <summary>Source code in <code>prefect_aws/s3.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@sync_compatible</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">upload_from_path</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">from_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
    <span class="n">to_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">upload_kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Uploads an object from a path to the S3 bucket.</span>

<span class="sd">    Args:</span>
<span class="sd">        from_path: The path to the file to upload from.</span>
<span class="sd">        to_path: The path to upload the file to.</span>
<span class="sd">        **upload_kwargs: Additional keyword arguments to pass to `Client.upload`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The path that the object was uploaded to.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Upload notes.txt to my_folder/notes.txt.</span>
<span class="sd">        ```python</span>
<span class="sd">        from prefect_aws.s3 import S3Bucket</span>

<span class="sd">        s3_bucket = S3Bucket.load(&quot;my-bucket&quot;)</span>
<span class="sd">        s3_bucket.upload_from_path(&quot;notes.txt&quot;, &quot;my_folder/notes.txt&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">from_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">from_path</span><span class="p">)</span><span class="o">.</span><span class="n">absolute</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">to_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">to_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">from_path</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>

    <span class="n">bucket_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_join_bucket_folder</span><span class="p">(</span><span class="n">to_path</span><span class="p">))</span>
    <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">get_s3_client</span><span class="p">()</span>

    <span class="k">await</span> <span class="n">run_sync_in_worker_thread</span><span class="p">(</span>
        <span class="n">client</span><span class="o">.</span><span class="n">upload_file</span><span class="p">,</span>
        <span class="n">Filename</span><span class="o">=</span><span class="n">from_path</span><span class="p">,</span>
        <span class="n">Bucket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="p">,</span>
        <span class="n">Key</span><span class="o">=</span><span class="n">bucket_path</span><span class="p">,</span>
        <span class="o">**</span><span class="n">upload_kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Uploaded from </span><span class="si">{</span><span class="n">from_path</span><span class="si">!r}</span><span class="s2"> to the bucket &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_name</span><span class="si">!r}</span><span class="s2"> path </span><span class="si">{</span><span class="n">bucket_path</span><span class="si">!r}</span><span class="s2">.&quot;</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">bucket_path</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="prefect_aws.s3.S3Bucket.write_path" class="doc doc-heading">
<code class="highlight language-python"><span class="n">write_path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Writes to an S3 bucket.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>path</code></td>
        <td><code>str</code></td>
        <td><p>The key name. Each object in your bucket has a unique
key (or key name).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>content</code></td>
        <td><code>bytes</code></td>
        <td><p>What you are uploading to S3.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <p>Write data to the path <code>dogs/small_dogs/havanese</code> in an S3 Bucket:
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect_aws</span> <span class="kn">import</span> <span class="n">MinioCredentials</span>
<span class="kn">from</span> <span class="nn">prefect_aws.s3</span> <span class="kn">import</span> <span class="n">S3Bucket</span>

<span class="n">minio_creds</span> <span class="o">=</span> <span class="n">MinIOCredentials</span><span class="p">(</span>
    <span class="n">minio_root_user</span> <span class="o">=</span> <span class="s2">&quot;minioadmin&quot;</span><span class="p">,</span>
    <span class="n">minio_root_password</span> <span class="o">=</span> <span class="s2">&quot;minioadmin&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">s3_bucket_block</span> <span class="o">=</span> <span class="n">S3Bucket</span><span class="p">(</span>
    <span class="n">bucket_name</span><span class="o">=</span><span class="s2">&quot;bucket&quot;</span><span class="p">,</span>
    <span class="n">minio_credentials</span><span class="o">=</span><span class="n">minio_creds</span><span class="p">,</span>
    <span class="n">bucket_folder</span><span class="o">=</span><span class="s2">&quot;dogs/smalldogs&quot;</span><span class="p">,</span>
    <span class="n">endpoint_url</span><span class="o">=</span><span class="s2">&quot;http://localhost:9000&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">s3_havanese_path</span> <span class="o">=</span> <span class="n">s3_bucket_block</span><span class="o">.</span><span class="n">write_path</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;havanese&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></p>

        <details class="quote">
          <summary>Source code in <code>prefect_aws/s3.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@sync_compatible</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">write_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes to an S3 bucket.</span>

<span class="sd">    Args:</span>

<span class="sd">        path: The key name. Each object in your bucket has a unique</span>
<span class="sd">            key (or key name).</span>
<span class="sd">        content: What you are uploading to S3.</span>

<span class="sd">    Example:</span>

<span class="sd">        Write data to the path `dogs/small_dogs/havanese` in an S3 Bucket:</span>
<span class="sd">        ```python</span>
<span class="sd">        from prefect_aws import MinioCredentials</span>
<span class="sd">        from prefect_aws.s3 import S3Bucket</span>

<span class="sd">        minio_creds = MinIOCredentials(</span>
<span class="sd">            minio_root_user = &quot;minioadmin&quot;,</span>
<span class="sd">            minio_root_password = &quot;minioadmin&quot;,</span>
<span class="sd">        )</span>

<span class="sd">        s3_bucket_block = S3Bucket(</span>
<span class="sd">            bucket_name=&quot;bucket&quot;,</span>
<span class="sd">            minio_credentials=minio_creds,</span>
<span class="sd">            bucket_folder=&quot;dogs/smalldogs&quot;,</span>
<span class="sd">            endpoint_url=&quot;http://localhost:9000&quot;,</span>
<span class="sd">        )</span>
<span class="sd">        s3_havanese_path = s3_bucket_block.write_path(path=&quot;havanese&quot;, content=data)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="k">await</span> <span class="n">run_sync_in_worker_thread</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_write_sync</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">path</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>


<h2 id="prefect_aws.s3-functions">Functions</h2>

  <div class="doc doc-object doc-function">



<h3 id="prefect_aws.s3.s3_copy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">s3_copy</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Uses S3's internal
<a href="https://docs.aws.amazon.com/AmazonS3/latest/API/API_CopyObject.html">CopyObject</a>
to copy objects within or between buckets. To copy objects between buckets, the
credentials must have permission to read the source object and write to the target
object. If the credentials do not have those permissions, try using
<code>S3Bucket.stream_from</code>.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>source_path</code></td>
        <td><code>str</code></td>
        <td><p>The path to the object to copy. Can be a string or <code>Path</code>.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>target_path</code></td>
        <td><code>str</code></td>
        <td><p>The path to copy the object to. Can be a string or <code>Path</code>.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>source_bucket_name</code></td>
        <td><code>str</code></td>
        <td><p>The bucket to copy the object from.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>aws_credentials</code></td>
        <td><code>AwsCredentials</code></td>
        <td><p>Credentials to use for authentication with AWS.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>target_bucket_name</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>The bucket to copy the object to. If not provided, defaults
to <code>source_bucket</code>.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>**copy_kwargs</code></td>
        <td></td>
        <td><p>Additional keyword arguments to pass to <code>S3Client.copy_object</code>.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The path that the object was copied to. Excludes the bucket name.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <p>Copy notes.txt from s3://my-bucket/my_folder/notes.txt to
s3://my-bucket/my_folder/notes_copy.txt.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect</span> <span class="kn">import</span> <span class="n">flow</span>
<span class="kn">from</span> <span class="nn">prefect_aws</span> <span class="kn">import</span> <span class="n">AwsCredentials</span>
<span class="kn">from</span> <span class="nn">prefect_aws.s3</span> <span class="kn">import</span> <span class="n">s3_copy</span>

<span class="n">aws_credentials</span> <span class="o">=</span> <span class="n">AwsCredentials</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;my-creds&quot;</span><span class="p">)</span>

<span class="nd">@flow</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">example_copy_flow</span><span class="p">():</span>
    <span class="k">await</span> <span class="n">s3_copy</span><span class="p">(</span>
        <span class="n">source_path</span><span class="o">=</span><span class="s2">&quot;my_folder/notes.txt&quot;</span><span class="p">,</span>
        <span class="n">target_path</span><span class="o">=</span><span class="s2">&quot;my_folder/notes_copy.txt&quot;</span><span class="p">,</span>
        <span class="n">source_bucket_name</span><span class="o">=</span><span class="s2">&quot;my-bucket&quot;</span><span class="p">,</span>
        <span class="n">aws_credentials</span><span class="o">=</span><span class="n">aws_credentials</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">example_copy_flow</span><span class="p">()</span>
</code></pre></div>
<p>Copy notes.txt from s3://my-bucket/my_folder/notes.txt to
s3://other-bucket/notes_copy.txt.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect</span> <span class="kn">import</span> <span class="n">flow</span>
<span class="kn">from</span> <span class="nn">prefect_aws</span> <span class="kn">import</span> <span class="n">AwsCredentials</span>
<span class="kn">from</span> <span class="nn">prefect_aws.s3</span> <span class="kn">import</span> <span class="n">s3_copy</span>

<span class="n">aws_credentials</span> <span class="o">=</span> <span class="n">AwsCredentials</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;shared-creds&quot;</span><span class="p">)</span>

<span class="nd">@flow</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">example_copy_flow</span><span class="p">():</span>
    <span class="k">await</span> <span class="n">s3_copy</span><span class="p">(</span>
        <span class="n">source_path</span><span class="o">=</span><span class="s2">&quot;my_folder/notes.txt&quot;</span><span class="p">,</span>
        <span class="n">target_path</span><span class="o">=</span><span class="s2">&quot;notes_copy.txt&quot;</span><span class="p">,</span>
        <span class="n">source_bucket_name</span><span class="o">=</span><span class="s2">&quot;my-bucket&quot;</span><span class="p">,</span>
        <span class="n">aws_credentials</span><span class="o">=</span><span class="n">aws_credentials</span><span class="p">,</span>
        <span class="n">target_bucket_name</span><span class="o">=</span><span class="s2">&quot;other-bucket&quot;</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">example_copy_flow</span><span class="p">()</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>prefect_aws/s3.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@task</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">s3_copy</span><span class="p">(</span>
    <span class="n">source_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">target_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">source_bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">aws_credentials</span><span class="p">:</span> <span class="n">AwsCredentials</span><span class="p">,</span>
    <span class="n">target_bucket_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">copy_kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Uses S3&#39;s internal</span>
<span class="sd">    [CopyObject](https://docs.aws.amazon.com/AmazonS3/latest/API/API_CopyObject.html)</span>
<span class="sd">    to copy objects within or between buckets. To copy objects between buckets, the</span>
<span class="sd">    credentials must have permission to read the source object and write to the target</span>
<span class="sd">    object. If the credentials do not have those permissions, try using</span>
<span class="sd">    `S3Bucket.stream_from`.</span>

<span class="sd">    Args:</span>
<span class="sd">        source_path: The path to the object to copy. Can be a string or `Path`.</span>
<span class="sd">        target_path: The path to copy the object to. Can be a string or `Path`.</span>
<span class="sd">        source_bucket_name: The bucket to copy the object from.</span>
<span class="sd">        aws_credentials: Credentials to use for authentication with AWS.</span>
<span class="sd">        target_bucket_name: The bucket to copy the object to. If not provided, defaults</span>
<span class="sd">            to `source_bucket`.</span>
<span class="sd">        **copy_kwargs: Additional keyword arguments to pass to `S3Client.copy_object`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The path that the object was copied to. Excludes the bucket name.</span>

<span class="sd">    Examples:</span>

<span class="sd">        Copy notes.txt from s3://my-bucket/my_folder/notes.txt to</span>
<span class="sd">        s3://my-bucket/my_folder/notes_copy.txt.</span>

<span class="sd">        ```python</span>
<span class="sd">        from prefect import flow</span>
<span class="sd">        from prefect_aws import AwsCredentials</span>
<span class="sd">        from prefect_aws.s3 import s3_copy</span>

<span class="sd">        aws_credentials = AwsCredentials.load(&quot;my-creds&quot;)</span>

<span class="sd">        @flow</span>
<span class="sd">        async def example_copy_flow():</span>
<span class="sd">            await s3_copy(</span>
<span class="sd">                source_path=&quot;my_folder/notes.txt&quot;,</span>
<span class="sd">                target_path=&quot;my_folder/notes_copy.txt&quot;,</span>
<span class="sd">                source_bucket_name=&quot;my-bucket&quot;,</span>
<span class="sd">                aws_credentials=aws_credentials,</span>
<span class="sd">            )</span>

<span class="sd">        example_copy_flow()</span>
<span class="sd">        ```</span>

<span class="sd">        Copy notes.txt from s3://my-bucket/my_folder/notes.txt to</span>
<span class="sd">        s3://other-bucket/notes_copy.txt.</span>

<span class="sd">        ```python</span>
<span class="sd">        from prefect import flow</span>
<span class="sd">        from prefect_aws import AwsCredentials</span>
<span class="sd">        from prefect_aws.s3 import s3_copy</span>

<span class="sd">        aws_credentials = AwsCredentials.load(&quot;shared-creds&quot;)</span>

<span class="sd">        @flow</span>
<span class="sd">        async def example_copy_flow():</span>
<span class="sd">            await s3_copy(</span>
<span class="sd">                source_path=&quot;my_folder/notes.txt&quot;,</span>
<span class="sd">                target_path=&quot;notes_copy.txt&quot;,</span>
<span class="sd">                source_bucket_name=&quot;my-bucket&quot;,</span>
<span class="sd">                aws_credentials=aws_credentials,</span>
<span class="sd">                target_bucket_name=&quot;other-bucket&quot;,</span>
<span class="sd">            )</span>

<span class="sd">        example_copy_flow()</span>
<span class="sd">        ```</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_run_logger</span><span class="p">()</span>

    <span class="n">s3_client</span> <span class="o">=</span> <span class="n">aws_credentials</span><span class="o">.</span><span class="n">get_s3_client</span><span class="p">()</span>

    <span class="n">target_bucket_name</span> <span class="o">=</span> <span class="n">target_bucket_name</span> <span class="ow">or</span> <span class="n">source_bucket_name</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="s2">&quot;Copying object from bucket </span><span class="si">%s</span><span class="s2"> with key </span><span class="si">%s</span><span class="s2"> to bucket </span><span class="si">%s</span><span class="s2"> with key </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">source_bucket_name</span><span class="p">,</span>
        <span class="n">source_path</span><span class="p">,</span>
        <span class="n">target_bucket_name</span><span class="p">,</span>
        <span class="n">target_path</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">s3_client</span><span class="o">.</span><span class="n">copy_object</span><span class="p">(</span>
        <span class="n">CopySource</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Bucket&quot;</span><span class="p">:</span> <span class="n">source_bucket_name</span><span class="p">,</span> <span class="s2">&quot;Key&quot;</span><span class="p">:</span> <span class="n">source_path</span><span class="p">},</span>
        <span class="n">Bucket</span><span class="o">=</span><span class="n">target_bucket_name</span><span class="p">,</span>
        <span class="n">Key</span><span class="o">=</span><span class="n">target_path</span><span class="p">,</span>
        <span class="o">**</span><span class="n">copy_kwargs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">target_path</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="prefect_aws.s3.s3_download" class="doc doc-heading">
<code class="highlight language-python"><span class="n">s3_download</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Downloads an object with a given key from a given S3 bucket.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bucket</code></td>
        <td><code>str</code></td>
        <td><p>Name of bucket to download object from. Required if a default value was
not supplied when creating the task.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>key</code></td>
        <td><code>str</code></td>
        <td><p>Key of object to download. Required if a default value was not supplied
when creating the task.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>aws_credentials</code></td>
        <td><code>AwsCredentials</code></td>
        <td><p>Credentials to use for authentication with AWS.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>aws_client_parameters</code></td>
        <td><code>AwsClientParameters</code></td>
        <td><p>Custom parameter for the boto3 client initialization.</p></td>
        <td><code>AwsClientParameters(api_version=None, use_ssl=True, verify=True, verify_cert_path=None, endpoint_url=None, config=None)</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bytes</code></td>
      <td><p>A <code>bytes</code> representation of the downloaded object.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <p>Download a file from an S3 bucket:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect</span> <span class="kn">import</span> <span class="n">flow</span>
<span class="kn">from</span> <span class="nn">prefect_aws</span> <span class="kn">import</span> <span class="n">AwsCredentials</span>
<span class="kn">from</span> <span class="nn">prefect_aws.s3</span> <span class="kn">import</span> <span class="n">s3_download</span>


<span class="nd">@flow</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">example_s3_download_flow</span><span class="p">():</span>
    <span class="n">aws_credentials</span> <span class="o">=</span> <span class="n">AwsCredentials</span><span class="p">(</span>
        <span class="n">aws_access_key_id</span><span class="o">=</span><span class="s2">&quot;acccess_key_id&quot;</span><span class="p">,</span>
        <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="s2">&quot;secret_access_key&quot;</span>
    <span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">s3_download</span><span class="p">(</span>
        <span class="n">bucket</span><span class="o">=</span><span class="s2">&quot;bucket&quot;</span><span class="p">,</span>
        <span class="n">key</span><span class="o">=</span><span class="s2">&quot;key&quot;</span><span class="p">,</span>
        <span class="n">aws_credentials</span><span class="o">=</span><span class="n">aws_credentials</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">example_s3_download_flow</span><span class="p">()</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>prefect_aws/s3.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@task</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">s3_download</span><span class="p">(</span>
    <span class="n">bucket</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">aws_credentials</span><span class="p">:</span> <span class="n">AwsCredentials</span><span class="p">,</span>
    <span class="n">aws_client_parameters</span><span class="p">:</span> <span class="n">AwsClientParameters</span> <span class="o">=</span> <span class="n">AwsClientParameters</span><span class="p">(),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Downloads an object with a given key from a given S3 bucket.</span>

<span class="sd">    Args:</span>
<span class="sd">        bucket: Name of bucket to download object from. Required if a default value was</span>
<span class="sd">            not supplied when creating the task.</span>
<span class="sd">        key: Key of object to download. Required if a default value was not supplied</span>
<span class="sd">            when creating the task.</span>
<span class="sd">        aws_credentials: Credentials to use for authentication with AWS.</span>
<span class="sd">        aws_client_parameters: Custom parameter for the boto3 client initialization.</span>


<span class="sd">    Returns:</span>
<span class="sd">        A `bytes` representation of the downloaded object.</span>

<span class="sd">    Example:</span>
<span class="sd">        Download a file from an S3 bucket:</span>

<span class="sd">        ```python</span>
<span class="sd">        from prefect import flow</span>
<span class="sd">        from prefect_aws import AwsCredentials</span>
<span class="sd">        from prefect_aws.s3 import s3_download</span>


<span class="sd">        @flow</span>
<span class="sd">        async def example_s3_download_flow():</span>
<span class="sd">            aws_credentials = AwsCredentials(</span>
<span class="sd">                aws_access_key_id=&quot;acccess_key_id&quot;,</span>
<span class="sd">                aws_secret_access_key=&quot;secret_access_key&quot;</span>
<span class="sd">            )</span>
<span class="sd">            data = await s3_download(</span>
<span class="sd">                bucket=&quot;bucket&quot;,</span>
<span class="sd">                key=&quot;key&quot;,</span>
<span class="sd">                aws_credentials=aws_credentials,</span>
<span class="sd">            )</span>

<span class="sd">        example_s3_download_flow()</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_run_logger</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Downloading object from bucket </span><span class="si">%s</span><span class="s2"> with key </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">bucket</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="n">s3_client</span> <span class="o">=</span> <span class="n">aws_credentials</span><span class="o">.</span><span class="n">get_boto3_session</span><span class="p">()</span><span class="o">.</span><span class="n">client</span><span class="p">(</span>
        <span class="s2">&quot;s3&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">aws_client_parameters</span><span class="o">.</span><span class="n">get_params_override</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">stream</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
    <span class="k">await</span> <span class="n">run_sync_in_worker_thread</span><span class="p">(</span>
        <span class="n">s3_client</span><span class="o">.</span><span class="n">download_fileobj</span><span class="p">,</span> <span class="n">Bucket</span><span class="o">=</span><span class="n">bucket</span><span class="p">,</span> <span class="n">Key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">Fileobj</span><span class="o">=</span><span class="n">stream</span>
    <span class="p">)</span>
    <span class="n">stream</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">output</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="prefect_aws.s3.s3_list_objects" class="doc doc-heading">
<code class="highlight language-python"><span class="n">s3_list_objects</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Lists details of objects in a given S3 bucket.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bucket</code></td>
        <td><code>str</code></td>
        <td><p>Name of bucket to list items from. Required if a default value was not
supplied when creating the task.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>aws_credentials</code></td>
        <td><code>AwsCredentials</code></td>
        <td><p>Credentials to use for authentication with AWS.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>aws_client_parameters</code></td>
        <td><code>AwsClientParameters</code></td>
        <td><p>Custom parameter for the boto3 client initialization..</p></td>
        <td><code>AwsClientParameters(api_version=None, use_ssl=True, verify=True, verify_cert_path=None, endpoint_url=None, config=None)</code></td>
      </tr>
      <tr>
        <td><code>prefix</code></td>
        <td><code>str</code></td>
        <td><p>Used to filter objects with keys starting with the specified prefix.</p></td>
        <td><code>&#39;&#39;</code></td>
      </tr>
      <tr>
        <td><code>delimiter</code></td>
        <td><code>str</code></td>
        <td><p>Character used to group keys of listed objects.</p></td>
        <td><code>&#39;&#39;</code></td>
      </tr>
      <tr>
        <td><code>page_size</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Number of objects to return in each request to the AWS API.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>max_items</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Maximum number of objects that to be returned by task.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>jmespath_query</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Query used to filter objects based on object attributes refer to
the <a href="https://boto3.amazonaws.com/v1/documentation/api/latest/guide/paginators.html#filtering-results-with-jmespath">boto3 docs</a>
for more information on how to construct queries.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[Dict[str, Any]]</code></td>
      <td><p>A list of dictionaries containing information about the objects retrieved. Refer
    to the boto3 docs for an example response.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <p>List all objects in a bucket:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect</span> <span class="kn">import</span> <span class="n">flow</span>
<span class="kn">from</span> <span class="nn">prefect_aws</span> <span class="kn">import</span> <span class="n">AwsCredentials</span>
<span class="kn">from</span> <span class="nn">prefect_aws.s3</span> <span class="kn">import</span> <span class="n">s3_list_objects</span>


<span class="nd">@flow</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">example_s3_list_objects_flow</span><span class="p">():</span>
    <span class="n">aws_credentials</span> <span class="o">=</span> <span class="n">AwsCredentials</span><span class="p">(</span>
        <span class="n">aws_access_key_id</span><span class="o">=</span><span class="s2">&quot;acccess_key_id&quot;</span><span class="p">,</span>
        <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="s2">&quot;secret_access_key&quot;</span>
    <span class="p">)</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="k">await</span> <span class="n">s3_list_objects</span><span class="p">(</span>
        <span class="n">bucket</span><span class="o">=</span><span class="s2">&quot;data_bucket&quot;</span><span class="p">,</span>
        <span class="n">aws_credentials</span><span class="o">=</span><span class="n">aws_credentials</span>
    <span class="p">)</span>

<span class="n">example_s3_list_objects_flow</span><span class="p">()</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>prefect_aws/s3.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@task</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">s3_list_objects</span><span class="p">(</span>
    <span class="n">bucket</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">aws_credentials</span><span class="p">:</span> <span class="n">AwsCredentials</span><span class="p">,</span>
    <span class="n">aws_client_parameters</span><span class="p">:</span> <span class="n">AwsClientParameters</span> <span class="o">=</span> <span class="n">AwsClientParameters</span><span class="p">(),</span>
    <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">delimiter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">page_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_items</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">jmespath_query</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Lists details of objects in a given S3 bucket.</span>

<span class="sd">    Args:</span>
<span class="sd">        bucket: Name of bucket to list items from. Required if a default value was not</span>
<span class="sd">            supplied when creating the task.</span>
<span class="sd">        aws_credentials: Credentials to use for authentication with AWS.</span>
<span class="sd">        aws_client_parameters: Custom parameter for the boto3 client initialization..</span>
<span class="sd">        prefix: Used to filter objects with keys starting with the specified prefix.</span>
<span class="sd">        delimiter: Character used to group keys of listed objects.</span>
<span class="sd">        page_size: Number of objects to return in each request to the AWS API.</span>
<span class="sd">        max_items: Maximum number of objects that to be returned by task.</span>
<span class="sd">        jmespath_query: Query used to filter objects based on object attributes refer to</span>
<span class="sd">            the [boto3 docs](https://boto3.amazonaws.com/v1/documentation/api/latest/guide/paginators.html#filtering-results-with-jmespath)</span>
<span class="sd">            for more information on how to construct queries.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of dictionaries containing information about the objects retrieved. Refer</span>
<span class="sd">            to the boto3 docs for an example response.</span>

<span class="sd">    Example:</span>
<span class="sd">        List all objects in a bucket:</span>

<span class="sd">        ```python</span>
<span class="sd">        from prefect import flow</span>
<span class="sd">        from prefect_aws import AwsCredentials</span>
<span class="sd">        from prefect_aws.s3 import s3_list_objects</span>


<span class="sd">        @flow</span>
<span class="sd">        async def example_s3_list_objects_flow():</span>
<span class="sd">            aws_credentials = AwsCredentials(</span>
<span class="sd">                aws_access_key_id=&quot;acccess_key_id&quot;,</span>
<span class="sd">                aws_secret_access_key=&quot;secret_access_key&quot;</span>
<span class="sd">            )</span>
<span class="sd">            objects = await s3_list_objects(</span>
<span class="sd">                bucket=&quot;data_bucket&quot;,</span>
<span class="sd">                aws_credentials=aws_credentials</span>
<span class="sd">            )</span>

<span class="sd">        example_s3_list_objects_flow()</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa E501</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_run_logger</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Listing objects in bucket </span><span class="si">%s</span><span class="s2"> with prefix </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">bucket</span><span class="p">,</span> <span class="n">prefix</span><span class="p">)</span>

    <span class="n">s3_client</span> <span class="o">=</span> <span class="n">aws_credentials</span><span class="o">.</span><span class="n">get_boto3_session</span><span class="p">()</span><span class="o">.</span><span class="n">client</span><span class="p">(</span>
        <span class="s2">&quot;s3&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">aws_client_parameters</span><span class="o">.</span><span class="n">get_params_override</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">paginator</span> <span class="o">=</span> <span class="n">s3_client</span><span class="o">.</span><span class="n">get_paginator</span><span class="p">(</span><span class="s2">&quot;list_objects_v2&quot;</span><span class="p">)</span>
    <span class="n">page_iterator</span> <span class="o">=</span> <span class="n">paginator</span><span class="o">.</span><span class="n">paginate</span><span class="p">(</span>
        <span class="n">Bucket</span><span class="o">=</span><span class="n">bucket</span><span class="p">,</span>
        <span class="n">Prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
        <span class="n">Delimiter</span><span class="o">=</span><span class="n">delimiter</span><span class="p">,</span>
        <span class="n">PaginationConfig</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;PageSize&quot;</span><span class="p">:</span> <span class="n">page_size</span><span class="p">,</span> <span class="s2">&quot;MaxItems&quot;</span><span class="p">:</span> <span class="n">max_items</span><span class="p">},</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">jmespath_query</span><span class="p">:</span>
        <span class="n">page_iterator</span> <span class="o">=</span> <span class="n">page_iterator</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">jmespath_query</span><span class="si">}</span><span class="s2"> | </span><span class="se">{{</span><span class="s2">Contents: @</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="k">await</span> <span class="n">run_sync_in_worker_thread</span><span class="p">(</span><span class="n">_list_objects_sync</span><span class="p">,</span> <span class="n">page_iterator</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="prefect_aws.s3.s3_move" class="doc doc-heading">
<code class="highlight language-python"><span class="n">s3_move</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Move an object from one S3 location to another. To move objects between buckets,
the credentials must have permission to read and delete the source object and write
to the target object. If the credentials do not have those permissions, this method
will raise an error. If the credentials have permission to read the source object
but not delete it, the object will be copied but not deleted.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>source_path</code></td>
        <td><code>str</code></td>
        <td><p>The path of the object to move</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>target_path</code></td>
        <td><code>str</code></td>
        <td><p>The path to move the object to</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>source_bucket_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the bucket containing the source object</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>aws_credentials</code></td>
        <td><code>AwsCredentials</code></td>
        <td><p>Credentials to use for authentication with AWS.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>target_bucket_name</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>The bucket to copy the object to. If not provided, defaults
to <code>source_bucket</code>.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The path that the object was moved to. Excludes the bucket name.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>prefect_aws/s3.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@task</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">s3_move</span><span class="p">(</span>
    <span class="n">source_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">target_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">source_bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">aws_credentials</span><span class="p">:</span> <span class="n">AwsCredentials</span><span class="p">,</span>
    <span class="n">target_bucket_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Move an object from one S3 location to another. To move objects between buckets,</span>
<span class="sd">    the credentials must have permission to read and delete the source object and write</span>
<span class="sd">    to the target object. If the credentials do not have those permissions, this method</span>
<span class="sd">    will raise an error. If the credentials have permission to read the source object</span>
<span class="sd">    but not delete it, the object will be copied but not deleted.</span>

<span class="sd">    Args:</span>
<span class="sd">        source_path: The path of the object to move</span>
<span class="sd">        target_path: The path to move the object to</span>
<span class="sd">        source_bucket_name: The name of the bucket containing the source object</span>
<span class="sd">        aws_credentials: Credentials to use for authentication with AWS.</span>
<span class="sd">        target_bucket_name: The bucket to copy the object to. If not provided, defaults</span>
<span class="sd">            to `source_bucket`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The path that the object was moved to. Excludes the bucket name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_run_logger</span><span class="p">()</span>

    <span class="n">s3_client</span> <span class="o">=</span> <span class="n">aws_credentials</span><span class="o">.</span><span class="n">get_s3_client</span><span class="p">()</span>

    <span class="c1"># If target bucket is not provided, assume it&#39;s the same as the source bucket</span>
    <span class="n">target_bucket_name</span> <span class="o">=</span> <span class="n">target_bucket_name</span> <span class="ow">or</span> <span class="n">source_bucket_name</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="s2">&quot;Moving object from s3://</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2"> s3://</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">source_bucket_name</span><span class="p">,</span>
        <span class="n">source_path</span><span class="p">,</span>
        <span class="n">target_bucket_name</span><span class="p">,</span>
        <span class="n">target_path</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Copy the object to the new location</span>
    <span class="n">s3_client</span><span class="o">.</span><span class="n">copy_object</span><span class="p">(</span>
        <span class="n">Bucket</span><span class="o">=</span><span class="n">target_bucket_name</span><span class="p">,</span>
        <span class="n">CopySource</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Bucket&quot;</span><span class="p">:</span> <span class="n">source_bucket_name</span><span class="p">,</span> <span class="s2">&quot;Key&quot;</span><span class="p">:</span> <span class="n">source_path</span><span class="p">},</span>
        <span class="n">Key</span><span class="o">=</span><span class="n">target_path</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Delete the original object</span>
    <span class="n">s3_client</span><span class="o">.</span><span class="n">delete_object</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="n">source_bucket_name</span><span class="p">,</span> <span class="n">Key</span><span class="o">=</span><span class="n">source_path</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">target_path</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="prefect_aws.s3.s3_upload" class="doc doc-heading">
<code class="highlight language-python"><span class="n">s3_upload</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Uploads data to an S3 bucket.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>bytes</code></td>
        <td><p>Bytes representation of data to upload to S3.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>bucket</code></td>
        <td><code>str</code></td>
        <td><p>Name of bucket to upload data to. Required if a default value was not
supplied when creating the task.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>aws_credentials</code></td>
        <td><code>AwsCredentials</code></td>
        <td><p>Credentials to use for authentication with AWS.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>aws_client_parameters</code></td>
        <td><code>AwsClientParameters</code></td>
        <td><p>Custom parameter for the boto3 client initialization..</p></td>
        <td><code>AwsClientParameters(api_version=None, use_ssl=True, verify=True, verify_cert_path=None, endpoint_url=None, config=None)</code></td>
      </tr>
      <tr>
        <td><code>key</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Key of object to download. Defaults to a UUID string.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The key of the uploaded object</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <p>Read and upload a file to an S3 bucket:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect</span> <span class="kn">import</span> <span class="n">flow</span>
<span class="kn">from</span> <span class="nn">prefect_aws</span> <span class="kn">import</span> <span class="n">AwsCredentials</span>
<span class="kn">from</span> <span class="nn">prefect_aws.s3</span> <span class="kn">import</span> <span class="n">s3_upload</span>


<span class="nd">@flow</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">example_s3_upload_flow</span><span class="p">():</span>
    <span class="n">aws_credentials</span> <span class="o">=</span> <span class="n">AwsCredentials</span><span class="p">(</span>
        <span class="n">aws_access_key_id</span><span class="o">=</span><span class="s2">&quot;acccess_key_id&quot;</span><span class="p">,</span>
        <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="s2">&quot;secret_access_key&quot;</span>
    <span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;data.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">key</span> <span class="o">=</span> <span class="k">await</span> <span class="n">s3_upload</span><span class="p">(</span>
            <span class="n">bucket</span><span class="o">=</span><span class="s2">&quot;bucket&quot;</span><span class="p">,</span>
            <span class="n">key</span><span class="o">=</span><span class="s2">&quot;data.csv&quot;</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
            <span class="n">aws_credentials</span><span class="o">=</span><span class="n">aws_credentials</span><span class="p">,</span>
        <span class="p">)</span>

<span class="n">example_s3_upload_flow</span><span class="p">()</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>prefect_aws/s3.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@task</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">s3_upload</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span>
    <span class="n">bucket</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">aws_credentials</span><span class="p">:</span> <span class="n">AwsCredentials</span><span class="p">,</span>
    <span class="n">aws_client_parameters</span><span class="p">:</span> <span class="n">AwsClientParameters</span> <span class="o">=</span> <span class="n">AwsClientParameters</span><span class="p">(),</span>
    <span class="n">key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Uploads data to an S3 bucket.</span>

<span class="sd">    Args:</span>
<span class="sd">        data: Bytes representation of data to upload to S3.</span>
<span class="sd">        bucket: Name of bucket to upload data to. Required if a default value was not</span>
<span class="sd">            supplied when creating the task.</span>
<span class="sd">        aws_credentials: Credentials to use for authentication with AWS.</span>
<span class="sd">        aws_client_parameters: Custom parameter for the boto3 client initialization..</span>
<span class="sd">        key: Key of object to download. Defaults to a UUID string.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The key of the uploaded object</span>

<span class="sd">    Example:</span>
<span class="sd">        Read and upload a file to an S3 bucket:</span>

<span class="sd">        ```python</span>
<span class="sd">        from prefect import flow</span>
<span class="sd">        from prefect_aws import AwsCredentials</span>
<span class="sd">        from prefect_aws.s3 import s3_upload</span>


<span class="sd">        @flow</span>
<span class="sd">        async def example_s3_upload_flow():</span>
<span class="sd">            aws_credentials = AwsCredentials(</span>
<span class="sd">                aws_access_key_id=&quot;acccess_key_id&quot;,</span>
<span class="sd">                aws_secret_access_key=&quot;secret_access_key&quot;</span>
<span class="sd">            )</span>
<span class="sd">            with open(&quot;data.csv&quot;, &quot;rb&quot;) as file:</span>
<span class="sd">                key = await s3_upload(</span>
<span class="sd">                    bucket=&quot;bucket&quot;,</span>
<span class="sd">                    key=&quot;data.csv&quot;,</span>
<span class="sd">                    data=file.read(),</span>
<span class="sd">                    aws_credentials=aws_credentials,</span>
<span class="sd">                )</span>

<span class="sd">        example_s3_upload_flow()</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_run_logger</span><span class="p">()</span>

    <span class="n">key</span> <span class="o">=</span> <span class="n">key</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Uploading object to bucket </span><span class="si">%s</span><span class="s2"> with key </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">bucket</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="n">s3_client</span> <span class="o">=</span> <span class="n">aws_credentials</span><span class="o">.</span><span class="n">get_boto3_session</span><span class="p">()</span><span class="o">.</span><span class="n">client</span><span class="p">(</span>
        <span class="s2">&quot;s3&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">aws_client_parameters</span><span class="o">.</span><span class="n">get_params_override</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">stream</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">await</span> <span class="n">run_sync_in_worker_thread</span><span class="p">(</span>
        <span class="n">s3_client</span><span class="o">.</span><span class="n">upload_fileobj</span><span class="p">,</span> <span class="n">stream</span><span class="p">,</span> <span class="n">Bucket</span><span class="o">=</span><span class="n">bucket</span><span class="p">,</span> <span class="n">Key</span><span class="o">=</span><span class="n">key</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">key</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>







  
  



  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.prefect.io/slack/" target="_blank" rel="noopener" title="www.prefect.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1c0-25.9 21.16-47.06 47.06-47.06h47.06v47.06zm23.72 0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9 0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96 0 222.8 0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72 0c0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9 0-47.06-21.16-47.06-47.06 0-25.9 21.16-47.06 47.06-47.06h117.84c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06H283.1z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://discourse.prefect.io/" target="_blank" rel="noopener" title="discourse.prefect.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M225.9 32C103.3 32 0 130.5 0 252.1 0 256 .1 480 .1 480l225.8-.2c122.7 0 222.1-102.3 222.1-223.9C448 134.3 348.6 32 225.9 32zM224 384c-19.4 0-37.9-4.3-54.4-12.1L88.5 392l22.9-75c-9.8-18.1-15.4-38.9-15.4-61 0-70.7 57.3-128 128-128s128 57.3 128 128-57.3 128-128 128z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.youtube.com/c/PrefectIO/videos" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://prefect.io/guide/" target="_blank" rel="noopener" title="prefect.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M168 80c-13.3 0-24 10.7-24 24v304c0 8.4-1.4 16.5-4.1 24H440c13.3 0 24-10.7 24-24V104c0-13.3-10.7-24-24-24H168zM72 480c-39.8 0-72-32.2-72-72V112c0-13.3 10.7-24 24-24s24 10.7 24 24v296c0 13.3 10.7 24 24 24s24-10.7 24-24V104c0-39.8 32.2-72 72-72h272c39.8 0 72 32.2 72 72v304c0 39.8-32.2 72-72 72H72zm104-344c0-13.3 10.7-24 24-24h96c13.3 0 24 10.7 24 24v80c0 13.3-10.7 24-24 24h-96c-13.3 0-24-10.7-24-24v-80zm200-24h32c13.3 0 24 10.7 24 24s-10.7 24-24 24h-32c-13.3 0-24-10.7-24-24s10.7-24 24-24zm0 80h32c13.3 0 24 10.7 24 24s-10.7 24-24 24h-32c-13.3 0-24-10.7-24-24s10.7-24 24-24zm-176 80h208c13.3 0 24 10.7 24 24s-10.7 24-24 24H200c-13.3 0-24-10.7-24-24s10.7-24 24-24zm0 80h208c13.3 0 24 10.7 24 24s-10.7 24-24 24H200c-13.3 0-24-10.7-24-24s10.7-24 24-24z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/PrefectIO" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/prefect/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/PrefectHQ/prefect" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://hub.docker.com/r/prefecthq/prefect/" target="_blank" rel="noopener" title="hub.docker.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1v59.4zm0-204.3h-66.1v60.7h66.1V32zm78.2 144.8H362v59.4h66.1v-59.4zm-156.3-72.1h-66.1v60.1h66.1v-60.1zm78.1 0h-66.1v60.1h66.1v-60.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1l-13.3-8.9zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm-78.1-72.1h-66.1v60.1h66.1v-60.1z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/prefect/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "content.code.annotate"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.3220b9d7.min.js"></script>
      
    
  </body>
</html>